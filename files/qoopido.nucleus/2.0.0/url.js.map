{"version":3,"sources":["url.js"],"names":["global","document","definition","base","functionDescriptorGenerate","functionUniqueUuid","resolveCurrent","resolver","createElement","href","slice","getLinkProperty","uuid","property","properties","storage","link","setLinkProperty","value","SearchParams","self","this","objectDefineProperties","update","call","Url","url","toString","enumerable","valueOf","parameter","searchParams","Object","defineProperties","regexMatchLeadingSlash","regexMatchParameter","regexMatchSpaces","regexMatchOpeningBrackets","regexMatchClosingBrackets","regexMatchLocal","RegExp","regexMatchDefaults","http:","https:","ftp:","prototype","get","name","set","serialize","remove","key","tokens","search","split","join","exec","decodeURIComponent","result","encodeURIComponent","replace","local","test","origin","protocol","host","username","password","hostname","port","pathname","hash","extend","provide"],"mappings":"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","file":"url.js","sourcesContent":["/**\n * Qoopido url\n *\n * Provides methods handle URLs\n *\n * Copyright (c) 2015 Dirk Lueth\n *\n * Dual licensed under the MIT and GPL licenses.\n *  - http://www.opensource.org/licenses/mit-license.php\n *  - http://www.gnu.org/copyleft/gpl.html\n *\n * @author Dirk Lueth <info@qoopido.com>\n *\n * @require ./base\n * @require ./function/descriptor/generate\n * @require ./function/unique/uuid\n */\n\n(function(global, document) {\n\t'use strict';\n\n\tfunction definition(base, functionDescriptorGenerate, functionUniqueUuid) {\n\t\tvar objectDefineProperties    = Object.defineProperties,\n\t\t\tstorage                   = {},\n\t\t\tregexMatchLeadingSlash    = /^\\//,\n\t\t\tregexMatchParameter       = /[?&]?([^=]+)=([^&]*)/g,\n\t\t\tregexMatchSpaces          = /%20/g,\n\t\t\tregexMatchOpeningBrackets = /%5B/g,\n\t\t\tregexMatchClosingBrackets = /%5D/g,\n\t\t\tregexMatchLocal           = new RegExp('^' + resolveCurrent(), 'i'),\n\t\t\tregexMatchDefaults        = {\n\t\t\t\t'http:':  /:80$/,\n\t\t\t\t'https:': /:443$/,\n\t\t\t\t'ftp:':   /:21$/\n\t\t\t};\n\n\t\tfunction resolveCurrent() {\n\t\t\tvar resolver = document.createElement('a');\n\n\t\t\tresolver.href = '/';\n\n\t\t\treturn resolver.href.slice(0, -1);\n\t\t}\n\n\t\tfunction getLinkProperty(uuid, property) {\n\t\t\tvar properties;\n\n\t\t\tif(properties = storage[uuid]) {\n\t\t\t\treturn properties.link[property];\n\t\t\t}\n\t\t}\n\n\t\tfunction setLinkProperty(uuid, property, value) {\n\t\t\tvar properties;\n\n\t\t\tif(properties = storage[uuid]) {\n\t\t\t\tproperties.link[property] = value;\n\t\t\t}\n\t\t}\n\n\t\tfunction SearchParams(uuid) {\n\t\t\tvar self = this;\n\n\t\t\tobjectDefineProperties(self, { uuid: functionDescriptorGenerate(uuid) });\n\n\t\t\tSearchParams.update.call(self);\n\t\t}\n\n\t\tSearchParams.prototype = {\n\t\t\t/* only for reference\n\t\t\tuuid: null\n\t\t\t*/\n\t\t\tget: function(name) {\n\t\t\t\treturn storage[this.uuid].parameter[name];\n\t\t\t},\n\t\t\tset: function(name, value) {\n\t\t\t\tstorage[this.uuid].parameter[name] = value;\n\n\t\t\t\tSearchParams.serialize.call(this);\n\t\t\t},\n\t\t\tremove: function(name) {\n\t\t\t\tdelete storage[this.uuid].parameter[name];\n\n\t\t\t\tSearchParams.serialize.call(this);\n\t\t\t}\n\t\t};\n\n\t\tSearchParams.update = function() {\n\t\t\tvar properties = storage[this.uuid],\n\t\t\t\tparameter  = properties.parameter,\n\t\t\t\tsearch     = properties.link.search.split('+').join(' '),\n\t\t\t\tkey, tokens;\n\n\t\t\tfor(key in parameter) {\n\t\t\t\tdelete parameter[key];\n\t\t\t}\n\n\t\t\twhile(tokens = regexMatchParameter.exec(search)) {\n\t\t\t\tparameter[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t\t\t}\n\t\t};\n\n\t\tSearchParams.serialize = function() {\n\t\t\tvar properties = storage[this.uuid],\n\t\t\t\tparameter  = properties.parameter,\n\t\t\t\tresult = '',\n\t\t\t\tkey;\n\n\t\t\tfor(key in parameter) {\n\t\t\t\tresult += (!result ? '?' : '&') + encodeURIComponent(key) + '=' + encodeURIComponent(parameter[key]);\n\t\t\t}\n\n\t\t\tproperties.link.search = result\n\t\t\t\t.replace(regexMatchSpaces, '+')\n\t\t\t\t.replace(regexMatchOpeningBrackets, '[')\n\t\t\t\t.replace(regexMatchClosingBrackets, ']');\n\t\t};\n\n\t\tfunction Url(url) {\n\t\t\tvar self      = this,\n\t\t\t\tuuid      = functionUniqueUuid(),\n\t\t\t\tlink      = document.createElement('a');\n\n\t\t\tobjectDefineProperties(self, {\n\t\t\t\tuuid:     functionDescriptorGenerate(uuid),\n\t\t\t\ttoString: {\n\t\t\t\t\tvalue: function() { return link.toString(); },\n\t\t\t\t\tenumerable: false\n\t\t\t\t},\n\t\t\t\tvalueOf: {\n\t\t\t\t\tvalue: function() { return link.valueOf(); },\n\t\t\t\t\tenumerable: false\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstorage[uuid] = {\n\t\t\t\tlink:      link,\n\t\t\t\tparameter: {}\n\t\t\t};\n\n\t\t\tlink.href         = url;\n\t\t\tself.searchParams = new SearchParams(uuid);\n\t\t}\n\n\t\tUrl.prototype = {\n\t\t\t/* only for reference\n\t\t\tuuid:         null,\n\t\t\tsearchParams: null,\n\t\t\t*/\n\t\t\tget local() {\n\t\t\t\tvar value;\n\n\t\t\t\tif(value = getLinkProperty(this.uuid, 'href')) {\n\t\t\t\t\treturn regexMatchLocal.test(value);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget href() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'href');\n\t\t\t},\n\t\t\tset href(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'href', value);\n\t\t\t},\n\t\t\tget origin() {\n\t\t\t\tvar self = this;\n\n\t\t\t\treturn getLinkProperty(self.uuid, 'origin') || self.protocol + '//' + self.host;\n\t\t\t},\n\t\t\tget protocol() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'protocol');\n\t\t\t},\n\t\t\tset protocol(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'protocol', value);\n\t\t\t},\n\t\t\tget username() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'username');\n\t\t\t},\n\t\t\tset username(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'username', value);\n\t\t\t},\n\t\t\tget password() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'password');\n\t\t\t},\n\t\t\tset password(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'password', value);\n\t\t\t},\n\t\t\tget host() {\n\t\t\t\tvar value, protocol;\n\n\t\t\t\tif(value = getLinkProperty(this.uuid, 'host')) {\n\t\t\t\t\tprotocol = getLinkProperty(this.uuid, 'protocol');\n\n\t\t\t\t\treturn regexMatchDefaults[protocol] ? value.replace(regexMatchDefaults[protocol], '') : value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tset host(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'host', value);\n\t\t\t},\n\t\t\tget hostname() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'hostname');\n\t\t\t},\n\t\t\tset hostname(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'hostname', value);\n\t\t\t},\n\t\t\tget port() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'port');\n\t\t\t},\n\t\t\tset port(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'port', value);\n\t\t\t},\n\t\t\tget pathname() {\n\t\t\t\tvar value;\n\n\t\t\t\tif(value = getLinkProperty(this.uuid, 'pathname')) {\n\t\t\t\t\treturn regexMatchLeadingSlash.test(value) ? value : '/' + value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tset pathname(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'pathname', value);\n\t\t\t},\n\t\t\tget search() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'search');\n\t\t\t},\n\t\t\tset search(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'search', value);\n\n\t\t\t\tSearchParams.update.call(this);\n\t\t\t},\n\t\t\tget hash() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'hash');\n\t\t\t},\n\t\t\tset hash(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'hash', value);\n\t\t\t}\n\t\t};\n\n\t\treturn base.extend(Url);\n\t}\n\n\tprovide([ './base', './function/descriptor/generate', './function/unique/uuid' ], definition);\n}(this, document));"],"sourceRoot":"/source/"}
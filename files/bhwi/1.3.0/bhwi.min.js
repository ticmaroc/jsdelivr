var Bhwi=function(){function i(t,e){new i.BhwiInitializer(t,e)}return i}(),Bhwi;!function(i){var t=function(){function i(i){var t={dom_element:"bhwi",type:"instagram",speed:4e3,form:"timeline",timeline_direction:"horizontal",images_number:{xs:3,sm:5,md:7,lg:9,xl:11},images_spacing:6,lightbox:!0,lightbox_key_navigation:{previous:37,next:39},lightbox_background:!1,preloading_images:!0,credits:!0,screen_widths:{xs:380,sm:544,md:768,lg:992,xl:1200}};this.options=jQuery.extend(t,i),this._validateOptions()}return i.prototype._validateOptions=function(){if("instagram"==this.options.type){if(null==this.options.client_id)throw new Error('For the instagram API the "client_id" is needed.')}else if(null==this.options.url)throw new Error('For the bhwi API the "url" is needed.')},i}(),e=function(){function i(i){this.dom_element=jQuery("#"+i).addClass("bhwi"),this.timer={}}return i.prototype.buildLink=function(i){return jQuery("<a>").attr({href:i,target:"_blank"})},i.prototype.buildImage=function(i,t){return jQuery("<div>").css("background",'url("'+t+'") center no-repeat').addClass("bhwi-image").data("bhwi-image-id",i)},i.prototype.buildSlide=function(i,t,e){return this.buildLink(i).append(this.buildImage(t,e))},i.prototype.buildDescription=function(i,t,e,n,o){var s=jQuery("<div>").addClass("bhwi-navigation").append(this.buildLeftAngleIcon(),this.buildRightAngleIcon(),this.buildCrossIcon()),h=jQuery("<div>").addClass("bhwi-description").text(e),r=this.buildLink(i).addClass("bhwi-author").text("@"+t);jQuery("<span>").text(this.shortDateFormat(new Date(1e3*n)));if(o.options.credits)var a=this.buildLink("https://blogger-heaven.com/?utm_source="+window.location.hostname+"&utm_medium=Widget&utm_campaign=BHWIWidget").text("blogger-heaven.com"),d=jQuery("<div>").addClass("bhwi-credits").append(a),l=jQuery("<footer>").append(d);else var l=jQuery("<footer>");return[s,r,h,l]},i.prototype.buildBackground=function(i){return jQuery("<div>").addClass("bhwi-full-background").css("background",'url("'+i+'") center no-repeat')},i.prototype.buildIcon=function(i,t,e){void 0===t&&(t=""),void 0===e&&(e="");var n="";return jQuery.each(i,function(i,t){n+='<path d="'+t+'"></path>'}),jQuery('<svg id="'+t+'" class="bhwi-icon '+e+'" version="1.1" xmlns="http://www.w3.org/2000/svg"><g>'+n+"</g></svg>")},i.prototype.buildCrossIcon=function(){return this.buildIcon(["M0,0l20,20","M20,0l-20,20"],"close-lightbox","close")},i.prototype.buildLeftAngleIcon=function(){return this.buildIcon(["M40,0l-30,30l30,30"],"previous-bhwi-image","left")},i.prototype.buildRightAngleIcon=function(){return this.buildIcon(["m0,0l30,30l-30,30"],"next-bhwi-image","right")},i.prototype.append=function(i){i.appendTo(this.dom_element)},i.prototype.interval=function(i,t){var e=this;i();var n=function(){e.interval(i,t)};setTimeout(n,t)},i.prototype.delay=function(i,t,e){clearTimeout(this.timer[i]),this.timer[i]=setTimeout(t,e)},i.prototype.nullTry=function(i,t){return null==i?i:i[t]},i.prototype.width=function(){try{return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}catch(i){return jQuery(window).width()}},i.prototype.shortDateFormat=function(i){return i.getDate()+"."+(i.getMonth()+1)+"."+i.getFullYear()},i.prototype.check_index=function(i,t){return i>t-1?0:0>i?t-1:i},i}(),n=function(){function i(i,t,e,n,o,s,h){this.bhwi_helper=i,this.dom_element=t,this.tolerance=10,this.upCallback=e,this.rightCallback=n,this.downCallback=o,this.leftCallback=s,this.remainedCallback=h,this.initEvents()}return i.prototype.initEvents=function(){var i=this,t=jQuery(document);t.on("touchstart",this.dom_element,function(t){i.startEvent=t,i.bhwi_helper.delay("touchstart",function(){i._start()},200)}),t.on("touchend",this.dom_element,function(t){i.endEvent=t,i.bhwi_helper.delay("touchend",function(){i._end()},200)})},i.prototype._start=function(){this.startX=this._getX(this.startEvent),this.startY=this._getY(this.startEvent)},i.prototype._end=function(){this.endX=this._getX(this.endEvent),this.endY=this._getY(this.endEvent),this._execCallback()},i.prototype._getX=function(i){return i.originalEvent.changedTouches[0].pageX},i.prototype._getY=function(i){return i.originalEvent.changedTouches[0].pageY},i.prototype._execCallback=function(){var i=Math.abs(this.endY-this.startY),t=Math.abs(this.endX-this.startX);return t>this.tolerance||i>this.tolerance?i>t?this.endY<this.startY?this.upCallback():this.downCallback():this.endX>this.startY?this.rightCallback():this.leftCallback():void this.remainedCallback()},i}(),o=function(){function i(i,t,e){var n=this;this._sildeImage=function(){var i=n.bhwi_helper.check_index(n.current_image.id+1,n.bhwi_images.images.length-1);null==n.current_dom&&(i=0),n._setImage(n.bhwi_images.find(i))},this.bhwi_helper=i,this.bhwi_images=t,this.bhwi_options=e,this.current_image=this.bhwi_images.find(0),this.speed=this.bhwi_options.options.speed,this.bhwi_helper.interval(this._sildeImage,this.speed),this.bhwi_helper.dom_element.addClass("bhwi-slider")}return i.prototype._setImage=function(i){null!=this.current_dom&&this.current_dom.fadeOut(this.speed/2),this.current_dom=this.bhwi_helper.dom_element.find(".bhwi-image:eq("+i.id+")").parent(),this.current_dom.length?this.current_dom.fadeIn(this.speed/2):(this.current_dom=this.bhwi_helper.buildSlide(i.link,i.id,i.low).fadeIn(this.speed/2),this.bhwi_helper.append(this.current_dom)),this.current_image=i},i}(),s=function(){function i(i,t){this.bhwi_helper=i,this.bhwi_options=t,this.images_number=this.images_number_for_width()}return i.prototype.images_number_for_width=function(){var i=this.bhwi_helper.width();return i<=this.bhwi_options.options.screen_widths.xs?this.bhwi_options.options.images_number.xs:i<=this.bhwi_options.options.screen_widths.sm?this.bhwi_options.options.images_number.sm:i<=this.bhwi_options.options.screen_widths.md?this.bhwi_options.options.images_number.md:i<=this.bhwi_options.options.screen_widths.lg?this.bhwi_options.options.images_number.lg:this.bhwi_options.options.images_number.xl},i}(),h=function(){function i(i,t,e,n){this.bhwi_helper=i,this.bhwi_timeline_helper=n,this.bhwi_images=t,this.bhwi_options=e,this.bhwi_helper.dom_element.addClass("bhwi-timeline-"+e.options.timeline_direction),this._setAllImages(),"horizontal"===e.options.timeline_direction&&(this._resizeImages(),this._responsiveImages())}return i.prototype._setAllImages=function(){var i=this;jQuery.each(this.bhwi_images.images,function(t,e){var n=i.bhwi_helper.buildSlide(e.link,e.id,e.low);return i.bhwi_helper.append(n),t==i.bhwi_timeline_helper.images_number-1?!1:void 0})},i.prototype._resizeImages=function(){var i=jQuery(this.bhwi_helper.dom_element).find(".bhwi-image"),t=this.bhwi_helper.dom_element.width()/this.bhwi_timeline_helper.images_number-this.bhwi_options.options.images_spacing;i.height(t).width(t)},i.prototype._responsiveImages=function(){var i=this;jQuery(window).resize(function(){i._resizeImages()})},i}(),r=function(){function i(i,t,e,n){this.bhwi_helper=i,this.bhwi_options=t,this.bhwi_images=e,this.total_images="timeline"==this.bhwi_options.options.form?n.images_number:this.bhwi_images.images.length,this._buildLightbox()}return i.prototype._buildLightbox=function(){var i=jQuery("<div>").addClass("bhwi-image-section"),t=jQuery("<div>").addClass("bhwi-text-section"),e=jQuery("<div>").addClass("bhwi-content"),n=jQuery("<div>").addClass("bhwi-full-background"),o=jQuery("<div>").addClass("bhwi-lightbox").attr("id","bhwi-lightbox");this.dom_element=o.append(n,e.append(i,t)).appendTo("body"),this._addLightboxListener(),this._addCloseListener()},i.prototype._addLightboxListener=function(){var i=this,t=function(t){t.preventDefault(),i._addImageToLightbox(i.bhwi_images.find(jQuery(t.target).data("bhwi-image-id")))};"slider"==this.bhwi_options.options.form?jQuery("#bhwi").on("click",".bhwi-image",t):jQuery(".bhwi-image").click(t)},i.prototype._addCloseListener=function(){var i=this;this.dom_element.click(function(t){("close-lightbox"==jQuery(t.target).attr("id")||!jQuery(t.target).closest(".bhwi-content").length&&""!=jQuery(t.target).attr("class")&&-1==jQuery(t.target).attr("class").indexOf("bhwi-icon"))&&i.dom_element.fadeOut()})},i.prototype._addPreviousImage=function(){this._addImageToLightbox(this.bhwi_images.find(this.bhwi_helper.check_index(this.current_image.id-1,this.total_images)))},i.prototype._addNextImage=function(){this._addImageToLightbox(this.bhwi_images.find(this.bhwi_helper.check_index(this.current_image.id+1,this.total_images)))},i.prototype._addIconNavigationListener=function(){var i=this;jQuery("#previous-bhwi-image").click(function(){i._addPreviousImage()}),jQuery("#next-bhwi-image").click(function(){i._addNextImage()})},i.prototype._addKeyNavigationListener=function(){var i=this;0!=this.bhwi_options.options.lightbox_key_navigation&&jQuery(document).keyup(function(t){i.bhwi_helper.delay("lightbox-navigation",function(){t.which==i.bhwi_options.options.lightbox_key_navigation.previous&&i._addPreviousImage(),t.which==i.bhwi_options.options.lightbox_key_navigation.next&&i._addNextImage()},200)})},i.prototype._addTouchNavigationListener=function(){var i=this;new n(this.bhwi_helper,"#bhwi-lightbox",function(){},function(){i._addNextImage()},function(){},function(){i._addPreviousImage()},function(){i.dom_element.fadeOut()}),this.bhwi_helper.width()<500&&this.dom_element.find(".bhwi-image-section a").click(function(i){i.preventDefault()})},i.prototype._addNavigationListener=function(){this.total_images=this.total_images--,this._addIconNavigationListener(),this._addKeyNavigationListener(),this._addTouchNavigationListener()},i.prototype._addImageToLightbox=function(i){this.current_image=i,this.bhwi_options.options.lightbox_background&&this.dom_element.find(".bhwi-full-background").replaceWith(this.bhwi_helper.buildBackground(i.standard)),this.dom_element.find(".bhwi-image-section").html(this.bhwi_helper.buildSlide(i.link,i.id,i.standard)),this.dom_element.find(".bhwi-text-section").html(this.bhwi_helper.buildDescription(i.link,i.author,i.text,i.created_time,this.bhwi_options)),this._addNavigationListener(),this.dom_element.is(":hidden")&&this.dom_element.fadeIn()},i}(),a=function(){function i(i,t,e,n,o,s,h,r){this.id=i,this.link=t,this.standard=e,this.low=n,this.thumbnail=o,this.author=s,this.text=h,this.created_time=r}return i}(),d=function(){function i(){this.images=new Array}return i.prototype.addImage=function(i){this.images.push(i)},i.prototype.addBuildImage=function(i,t,e,n,o,s,h){this.addImage(new a(this.images.length,i,t,e,n,o,s,h))},i.prototype.find=function(i){return this.images[i]},i.prototype.preloadingImages=function(){var i=new Image;jQuery.each(this.images,function(t,e){i.src=e.low,i.src=e.standard})},i}(),l=function(){function i(i,t){this.id=i,"bhwi"===t.options.type?this.url=this._buildBhwiUrl(t.options.url):this.url=this._buildInstagramUrl(t.options.client_id)}return i.prototype._buildInstagramUrl=function(i){return"https://api.instagram.com/v1/users/"+this.id+"/media/recent/?client_id="+i+"&callback=?"},i.prototype._buildBhwiUrl=function(i){return i+this.id},i}(),u=function(){function i(i,n){var a=this;this._initBhwiSlider=function(){a.bhwi_silder=new o(a.bhwi_helper,a.bhwi_images,a.bhwi_options)},this._initBhwiTimeline=function(){a.bhwi_timeline=new h(a.bhwi_helper,a.bhwi_images,a.bhwi_options,a.bhwi_timeline_helper)},this._decideInit=function(){switch(this.bhwi_options.options.form){case"slider":this._initBhwiSlider();break;default:this._initBhwiTimeline()}this.bhwi_options.options.lightbox&&new r(this.bhwi_helper,this.bhwi_options,this.bhwi_images,this.bhwi_timeline_helper)},this._basicVaildation(i,n),this.bhwi_options=new t(n),this.bhwi_helper=new e(this.bhwi_options.options.dom_element),this.bhwi_timeline_helper=new s(this.bhwi_helper,this.bhwi_options),this.bhwi_user=new l(i,this.bhwi_options),this.bhwi_images=new d,this._callApi()}return i.prototype._callApi=function(){var i=this;jQuery.getJSON(this.bhwi_user.url).done(function(t){jQuery.each(t.data,function(t,e){i.bhwi_images.addBuildImage(e.link,e.images.standard_resolution.url,e.images.low_resolution.url,e.images.thumbnail.url,e.user.username,i.bhwi_helper.nullTry(e.caption,"text"),e.created_time),i.bhwi_options.options.preloading_images&&i.bhwi_images.preloadingImages()}),i._decideInit()})},i.prototype._basicVaildation=function(i,t){if(null==i)throw new Error('The param "id" is required.');if(null==t)throw new Error('The param "options" are required.')},i}();i.BhwiInitializer=u}(Bhwi||(Bhwi={}));
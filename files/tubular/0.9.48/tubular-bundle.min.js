"use strict";var tubularTemplateServiceModule={enums:{dataTypes:["numeric","date","boolean","string"],editorTypes:["tbSimpleEditor","tbNumericEditor","tbDateTimeEditor","tbDateEditor","tbDropdownEditor","tbTypeaheadEditor","tbHiddenField","tbCheckboxField","tbTextArea"],httpMethods:["POST","PUT","GET","DELETE"],gridModes:["Read-Only","Inline","Popup","Page"],formLayouts:["Simple","Two-columns","Three-columns"],sortDirections:["Ascending","Descending"]},defaults:{gridOptions:{Pager:!0,FreeTextSearch:!0,PageSizeSelector:!0,PagerInfo:!0,ExportCsv:!0,Mode:"Read-Only",RequireAuthentication:!1,ServiceName:"",RequestMethod:"GET",GridName:"grid"},formOptions:{CancelButton:!0,SaveUrl:"",SaveMethod:"POST",Layout:"Simple",ModelKey:"",RequireAuthentication:!1,ServiceName:"",dataUrl:""},fieldsSettings:{tbSimpleEditor:{ShowLabel:!0,Placeholder:!0,Format:!1,Help:!0,Required:!0,ReadOnly:!0,EditorType:!0},tbNumericEditor:{ShowLabel:!0,Placeholder:!0,Format:!0,Help:!0,Required:!0,ReadOnly:!0,EditorType:!1},tbDateTimeEditor:{ShowLabel:!0,Placeholder:!1,Format:!0,Help:!0,Required:!0,ReadOnly:!0,EditorType:!1},tbDateEditor:{ShowLabel:!0,Placeholder:!1,Format:!0,Help:!0,Required:!0,ReadOnly:!0,EditorType:!1},tbDropdownEditor:{ShowLabel:!0,Placeholder:!1,Format:!1,Help:!0,Required:!0,ReadOnly:!0,EditorType:!1},tbTypeaheadEditor:{ShowLabel:!0,Placeholder:!0,Format:!1,Help:!0,Required:!0,ReadOnly:!0,EditorType:!1},tbHiddenField:{ShowLabel:!1,Placeholder:!1,Format:!1,Help:!1,Required:!1,ReadOnly:!1,EditorType:!1},tbCheckboxField:{ShowLabel:!1,Placeholder:!1,Format:!1,Help:!0,Required:!1,ReadOnly:!0,EditorType:!1},tbTextArea:{ShowLabel:!0,Placeholder:!0,Help:!0,Required:!0,ReadOnly:!0,EditorType:!1}}},createColumns:function(n){var e=n instanceof Array&&n.length>0?n[0]:n,u=[],i,r,f,o,s,t;for(i in e)if(e.hasOwnProperty(i)){if(r=e[i],i[0]==="$"||typeof r=="function")continue;if(r==null)continue;typeof r=="number"||parseFloat(r).toString()==r?u.push({Name:i,DataType:"numeric",Template:"{{row."+i+" | number}}"}):toString.call(r)==="[object Date]"||isNaN(new Date(r).getTime())===!1?u.push({Name:i,DataType:"date",Template:"{{row."+i+" | date}}"}):r.toLowerCase()==="true"||r.toLowerCase()==="false"?u.push({Name:i,DataType:"boolean",Template:"{{row."+i+' ? "TRUE" : "FALSE" }}'}):(f={Name:i,DataType:"string",Template:"{{row."+i+"}}"},/e(-|)mail/ig.test(f.Name)&&(f.Template='<a href="mailto:'+f.Template+'">'+f.Template+"<\/a>"),u.push(f))}o=!1;for(s in u)u.hasOwnProperty(s)&&(t=u[s],t.Label=t.Name.replace(/([a-z])([A-Z])/g,"$1 $2"),t.EditorType=this.getEditorTypeByDateType(t.DataType),t.Searchable=t.DataType==="string",t.Filter=!0,t.Visible=!0,t.Sortable=!0,t.IsKey=!1,t.SortOrder=0,t.SortDirection="",t.ShowLabel=!0,t.Placeholder="",t.Format="",t.Help="",t.Required=!0,t.ReadOnly=!1,o||(t.IsKey=!0,t.SortOrder=1,t.SortDirection="Ascending",o=!0));return u},generateFieldsArray:function(n){return n.map(function(n){var i=n.EditorType.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()}),t=tubularTemplateServiceModule.defaults.fieldsSettings[n.EditorType];return"\r\n\t<"+i+' name="'+n.Name+'"'+(t.EditorType?'\r\n\t\teditor-type="'+n.DataType+'" ':"")+(t.ShowLabel?'\r\n\t\tlabel="'+n.Label+'" show-label="'+n.ShowLabel+'"':"")+(t.Placeholder?'\r\n\t\tplaceholder="'+n.Placeholder+'"':"")+(t.Required?'\r\n\t\trequired="'+n.Required+'"':"")+(t.ReadOnly?'\r\n\t\tread-only="'+n.ReadOnly+'"':"")+(t.Format?'\r\n\t\tformat="'+n.Format+'"':"")+(t.Help?'\r\n\t\thelp="'+n.Help+'"':"")+">\r\n\t<\/"+i+">"})},generateFields:function(n){return this.generateFieldsArray(n).join("")},generatePopup:function(n,t){var i=this.createColumns(n);return'<tb-form model="Model"><div class="modal-header"><h3 class="modal-title">'+(t||"Edit Row")+'<\/h3><\/div><div class="modal-body">'+this.generateFields(i)+'<\/div><div class="modal-footer"><button class="btn btn-primary" ng-click="savePopup()" ng-disabled="!Model.$valid()">Save<\/button><button class="btn btn-danger" ng-click="closePopup()" formnovalidate>Cancel<\/button><\/div><\/tb-form>'},getEditorTypeByDateType:function(n){switch(n){case"date":return"tbDateTimeEditor";case"numeric":return"tbNumericEditor";case"boolean":return"tbCheckboxField";default:return"tbSimpleEditor"}},generateForm:function(n,t){var r=t.Layout==="Simple"?"":t.Layout.toLowerCase(),i=this.generateFieldsArray(n),u="";return u=r==""?i.join(""):"\r\n\t<div class='row'>"+(r=="two-columns"?"\r\n\t<div class='col-md-6'>"+i.filter(function(n,t){return t%2==0}).join("")+"\r\n\t<\/div>\r\n\t<div class='col-md-6'>"+i.filter(function(n,t){return t%2==1}).join("")+"<\/div>":"\r\n\t<div class='col-md-4'>"+i.filter(function(n,t){return t%3==0}).join("")+"\r\n\t<\/div>\r\n\t<div class='col-md-4'>"+i.filter(function(n,t){return t%3==1}).join("")+"\r\n\t<\/div>\r\n\t<div class='col-md-4'>"+i.filter(function(n,t){return t%3==2}).join("")+"\r\n\t<\/div>")+"\r\n\t<\/div>",'<tb-form server-save-method="'+t.SaveMethod+'" model-key="'+t.ModelKey+'" require-authentication="'+t.RequireAuthentication+'" server-url="'+t.dataUrl+'" server-save-url="'+t.SaveUrl+'"'+(t.ServiceName!=""?' service-name="'+t.ServiceName+'"':"")+">\r\n\t"+u+'\r\n\t<div>\r\n\t\t<button class="btn btn-primary" ng-click="$parent.save()" ng-disabled="!$parent.model.$valid()">Save<\/button>'+(t.CancelButton?'\r\n\t\t<button class="btn btn-danger" ng-click="$parent.cancel()" formnovalidate>Cancel<\/button>':"")+"\r\n\t<\/div>\r\n<\/tb-form>"},generateCells:function(n,t){return n.map(function(n){var i=n.EditorType.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()});return'\r\n\t\t<tb-cell-template column-name="'+n.Name+'">\r\n\t\t\t'+(t=="Inline"?"<"+i+' is-editing="row.$isEditing" value="row.'+n.Name+'"><\/'+i+">":n.Template)+"\r\n\t\t<\/tb-cell-template>"}).join("")},generateGrid:function(n,t){var i="",r="";return t.Pager&&(i+='\r\n\t<tb-grid-pager class="col-md-6"><\/tb-grid-pager>',r+='\r\n\t<tb-grid-pager class="col-md-6"><\/tb-grid-pager>'),t.ExportCsv&&(i+='\r\n\t<div class="col-md-3">\r\n\t\t<div class="btn-group">\r\n\t\t<tb-print-button title="Tubular" class="btn-sm"><\/tb-print-button>\r\n\t\t<tb-export-button filename="tubular.csv" css="btn-sm"><\/tb-export-button>\r\n\t\t<\/div>\r\n\t<\/div>'),t.FreeTextSearch&&(i+='\r\n\t<tb-text-search class="col-md-3" css="input-sm"><\/tb-text-search>'),t.PageSizeSelector&&(r+='\r\n\t<tb-page-size-selector class="col-md-3" selectorcss="input-sm"><\/tb-page-size-selector>'),t.PagerInfo&&(r+='\r\n\t<tb-grid-pager-info class="col-md-3"><\/tb-grid-pager-info>'),'<div class="container">\r\n<tb-grid server-url="'+t.dataUrl+'" request-method="'+t.RequestMethod+'" class="row" page-size="10" require-authentication="'+t.RequireAuthentication+'" '+(t.ServiceName!=""?' service-name="'+t.ServiceName+'"':"")+(t.Mode!="Read-Only"?' editor-mode="'+t.Mode.toLowerCase()+'"':"")+">"+(i===""?"":'\r\n\t<div class="row">'+i+"\r\n\t<\/div>")+'\r\n\t<div class="row">\r\n\t<div class="col-md-12">\r\n\t<div class="panel panel-default panel-rounded">\r\n\t<tb-grid-table class="table-bordered">\r\n\t<tb-column-definitions>'+(t.Mode!="Read-Only"?'\r\n\t\t<tb-column label="Actions"><tb-column-header>{{label}}<\/tb-column-header><\/tb-column>':"")+n.map(function(n){return'\r\n\t\t<tb-column name="'+n.Name+'" label="'+n.Label+'" column-type="'+n.DataType+'" sortable="'+n.Sortable+'" \r\n\t\t\tis-key="'+n.IsKey+'" searchable="'+n.Searchable+'" '+(n.Sortable?'\r\n\t\t\tsort-direction="'+n.SortDirection+'" sort-order="'+n.SortOrder+'" ':" ")+'visible="'+n.Visible+'">'+(n.Filter?"\r\n\t\t\t<tb-column-filter><\/tb-column-filter>":"")+"\r\n\t\t\t<tb-column-header>{{label}}<\/tb-column-header>\r\n\t\t<\/tb-column>"}).join("")+'\r\n\t<\/tb-column-definitions>\r\n\t<tb-row-set>\r\n\t<tb-row-template ng-repeat="row in $component.rows" row-model="row">'+(t.Mode!="Read-Only"?"\r\n\t\t<tb-cell-template>"+(t.Mode=="Inline"?'\r\n\t\t\t<tb-save-button model="row"><\/tb-save-button>':"")+'\r\n\t\t\t<tb-edit-button model="row"><\/tb-edit-button>\r\n\t\t<\/tb-cell-template>':"")+this.generateCells(n,t.Mode)+"\r\n\t<\/tb-row-template>\r\n\t<\/tb-row-set>\r\n\t<\/tb-grid-table>\r\n\t<\/div>\r\n\t<\/div>\r\n\t<\/div>"+(r===""?"":'\r\n\t<div class="row">'+r+"\r\n\t<\/div>")+"\r\n<\/tb-grid>\r\n<\/div>"}};try{module.exports=tubularTemplateServiceModule}catch(e){}angular.module("a8m.filter-watcher",[]).provider("filterWatcher",function(){this.$get=["$window","$rootScope",function(n,t){function u(n,t){return[n,angular.toJson(t)].join("#").replace(/"/g,"")}function e(n){var t=n.targetScope.$id;forEach(i[t],function(n){delete r[n]});delete i[t]}function o(){f(function(){t.$$phase||(r={})})}function s(n,t){var r=n.$id;return isUndefined(i[r])&&(n.$on("$destroy",e),i[r]=[]),i[r].push(t)}function h(n,t){var i=u(n,t);return r[i]}function c(n){return n&&n.$evalAsync&&n.$watch}function l(n,t,i,f){var e=u(n,t);return r[e]=f,c(i)?s(i,e):o(),f}var r={},i={},f=n.setTimeout;return{isMemoized:h,memoize:l}}]});angular.module("a8m.group-by",["a8m.filter-watcher"]).filter("groupBy",["$parse","filterWatcher",function(n,t){return function(i,r){function f(n,t){var i={},r;return angular.forEach(n,function(n){r=t(n);i[r]||(i[r]=[]);i[r].push(n)}),i}if(!angular.isObject(i)||angular.isUndefined(r))return i;var u=n(r);return t.isMemoized("groupBy",arguments)||t.memoize("groupBy",arguments,this,f(i,u))}}]),function(){angular.module("tubular",["tubular.directives","tubular.services","tubular.models","LocalStorageModule","a8m.group-by"]).config(["localStorageServiceProvider",function(n){n.setPrefix("tubular");typeof console=="undefined"&&(window.console={log:function(){},debug:function(){},error:function(){},assert:function(){},info:function(){},warn:function(){}})}]).run(["tubularHttp","tubularOData","tubularLocalData",function(n,t,i){n.registerService("odata",t);n.registerService("local",i)}]).constant("tubularConst",{upCssClass:"fa-long-arrow-up",downCssClass:"fa-long-arrow-down"}).filter("errormessage",function(){return function(n){return angular.isDefined(n)&&angular.isDefined(n.data)&&n.data&&angular.isDefined(n.data.ExceptionMessage)?n.data.ExceptionMessage:n.statusText||"Connection Error"}}).filter("numberorcurrency",["$filter",function(n){return function(t,i,r,u){return(r=r||"$",u=u||2,i==="C")?n("currency")(t,r,u):i==="I"?parseInt(t):n("number")(t,u)}}]).filter("characters",function(){return function(n,t,i){if(isNaN(t))return n;if(t<=0)return"";if(n&&n.length>t){if(n=n.substring(0,t),i)while(n.charAt(n.length-1)===" ")n=n.substr(0,n.length-1);else{var r=n.lastIndexOf(" ");r!==-1&&(n=n.substr(0,r))}return n+"\u2026"}return n}})}(),function(){angular.module("tubular.directives",["tubular.services","tubular.models"]).directive("tbGrid",[function(){return{template:'<div class="tubular-grid"><div class="tubular-overlay" ng-show="showLoading && currentRequest != null"><div><div class="fa fa-refresh fa-2x fa-spin"><\/div><\/div><\/div><ng-transclude><\/ng-transclude><\/div>',restrict:"E",replace:!0,transclude:!0,scope:{serverUrl:"@",serverSaveUrl:"@",serverDeleteUrl:"@",serverSaveMethod:"@",pageSize:"=?",onBeforeGetData:"=?",requestMethod:"@",dataServiceName:"@?serviceName",requireAuthentication:"@?",name:"@?gridName",editorMode:"@?",showLoading:"=?",autoRefresh:"=?",savePage:"=?",savePageSize:"=?",saveSearch:"=?"},controller:["$scope","localStorageService","tubularPopupService","tubularModel","tubularHttp","$routeParams",function(n,t,i,r,u,f){n.name=n.name||"tbgrid";n.tubularDirective="tubular-grid";n.columns=[];n.rows=[];n.savePage=angular.isUndefined(n.savePage)?!0:n.savePage;n.currentPage=n.savePage?t.get(n.name+"_page")||1:1;n.savePageSize=angular.isUndefined(n.savePageSize)?!0:n.savePageSize;n.pageSize=angular.isUndefined(n.pageSize)?20:n.pageSize;n.saveSearch=angular.isUndefined(n.saveSearch)?!0:n.saveSearch;n.totalPages=0;n.totalRecordCount=0;n.filteredRecordCount=0;n.requestedPage=n.currentPage;n.hasColumnsDefinitions=!1;n.requestCounter=0;n.requestMethod=n.requestMethod||"POST";n.serverSaveMethod=n.serverSaveMethod||"POST";n.requestTimeout=15e3;n.currentRequest=null;n.autoSearch=f.param||(n.saveSearch?t.get(n.name+"_search")||"":"");n.search={Text:n.autoSearch,Operator:n.autoSearch==""?"None":"Auto"};n.isEmpty=!1;n.tempRow=new r(n,{});n.dataService=u.getDataService(n.dataServiceName);n.requireAuthentication=n.requireAuthentication||!0;u.setRequireAuthentication(n.requireAuthentication);n.editorMode=n.editorMode||"none";n.canSaveState=!1;n.groupBy="";n.showLoading=angular.isUndefined(n.showLoading)?!0:n.showLoading;n.autoRefresh=angular.isUndefined(n.autoRefresh)?!0:n.autoRefresh;n.serverDeleteUrl=n.serverDeleteUrl||n.serverSaveUrl;n.$watch("columns",function(){n.hasColumnsDefinitions!==!1&&n.canSaveState!==!1&&t.set(n.name+"_columns",n.columns)},!0);n.$watch("serverUrl",function(t,i){n.hasColumnsDefinitions===!1||n.currentRequest||t===i||n.retrieveData()},!0);n.saveSearch=function(){n.saveSearch&&(n.search.Text===""?t.remove(n.name+"_search"):t.set(n.name+"_search",n.search.Text))};n.addColumn=function(t){if(t.Name!=null){if(n.hasColumnsDefinitions!==!1)throw"Cannot define more columns. Column definitions have been sealed";n.columns.push(t)}};n.newRow=function(t,u,f){n.tempRow=new r(n,{},n.dataService);n.tempRow.$isNew=!0;n.tempRow.$isEditing=!0;n.tempRow.$component=n;angular.isDefined(t)&&angular.isDefined(u)&&u&&i.openDialog(t,n.tempRow,n,f)};n.deleteRow=function(t){var i=n.serverDeleteUrl.split("?"),r=i[0]+"/"+t.$key,u;i.length>1&&(r+="?"+i[1]);u={serverUrl:r,requestMethod:"DELETE",timeout:n.requestTimeout,requireAuthentication:n.requireAuthentication};n.currentRequest=n.dataService.retrieveDataAsync(u);n.currentRequest.promise.then(function(i){t.$hasChanges=!1;n.$emit("tbGrid_OnRemove",i)},function(t){n.$emit("tbGrid_OnConnectionError",t)}).then(function(){n.currentRequest=null;n.retrieveData()})};n.verifyColumns=function(){var i=t.get(n.name+"_columns"),r,e,f,u;if(i==null||i===""){t.set(n.name+"_columns",n.columns);return}for(r in i)if(i.hasOwnProperty(r)){if(e=i[r].Name,f=n.columns.filter(function(n){return n.Name==e}),f.length===0)continue;if(u=f[0],u.Visible=i[r].Visible,n.requestCounter<1&&(u.SortOrder=i[r].SortOrder,u.SortDirection=i[r].SortDirection),u.Filter!=null&&u.Filter.Text!=null)continue;i[r].Filter!=null&&i[r].Filter.Text!=null&&i[r].Filter.Operator!="None"&&(u.Filter=i[r].Filter)}};n.retrieveData=function(){var u,f;n.serverUrl!=""&&(n.canSaveState=!0,n.verifyColumns(),n.savePageSize&&(n.pageSize=t.get(n.name+"_pageSize")||n.pageSize),n.pageSize<10&&(n.pageSize=20),u=(n.requestedPage-1)*n.pageSize,u<0&&(u=0),f={serverUrl:n.serverUrl,requestMethod:n.requestMethod||"POST",timeout:n.requestTimeout,requireAuthentication:n.requireAuthentication,data:{Count:n.requestCounter,Columns:n.columns,Skip:u,Take:parseInt(n.pageSize),Search:n.search,TimezoneOffset:(new Date).getTimezoneOffset()}},n.currentRequest===null)&&(angular.isUndefined(n.onBeforeGetData)===!1&&n.onBeforeGetData(),n.$emit("tbGrid_OnBeforeRequest",f,n),n.currentRequest=n.dataService.retrieveDataAsync(f),n.currentRequest.promise.then(function(u){if(n.requestCounter+=1,angular.isUndefined(u)||u==null){n.$emit("tbGrid_OnConnectionError",{statusText:"Data is empty",status:0});return}n.dataSource=u;n.rows=u.Payload.map(function(t){var u=new r(n,t,n.dataService);return u.$component=n,u.editPopup=function(t,r){i.openDialog(t,u,n,r)},u});n.$emit("tbGrid_OnDataLoaded",n);n.aggregationFunctions=u.AggregationPayload;n.currentPage=u.CurrentPage;n.totalPages=u.TotalPages;n.totalRecordCount=u.TotalRecordCount;n.filteredRecordCount=u.FilteredRecordCount;n.isEmpty=n.filteredRecordCount===0;n.savePage&&t.set(n.name+"_page",n.currentPage)},function(t){n.requestedPage=n.currentPage;n.$emit("tbGrid_OnConnectionError",t)}).then(function(){n.currentRequest=null}))};n.$watch("hasColumnsDefinitions",function(t){if(t===!0){var i=!1;angular.forEach(n.columns,function(t){if(t.IsGrouping){if(i)throw"Only one column is allowed to grouping";i=!0;t.Visible=!1;t.Sortable=!0;t.SortOrder=1;n.groupBy=t.Name}});angular.forEach(n.columns,function(t){n.groupBy!=t.Name&&t.Sortable&&t.SortOrder>0&&t.SortOrder++});n.retrieveData()}});n.$watch("pageSize",function(){n.hasColumnsDefinitions&&n.requestCounter>0&&(n.savePageSize&&t.set(n.name+"_pageSize",n.pageSize),n.retrieveData())});n.$watch("requestedPage",function(){n.hasColumnsDefinitions&&n.requestCounter>0&&n.retrieveData()});n.sortColumn=function(t,i){var o=n.columns.filter(function(n){return n.Name===t}),r,u,f,e;o.length!==0&&(r=o[0],r.Sortable!==!1)&&(u=r.SortDirection,f=u==="None"?"Ascending":u==="Ascending"?"Descending":"None",f==="None"?(r.SortOrder=-1,r.SortDirection="None"):(r.SortOrder=Number.MAX_VALUE,r.SortDirection=f),i===!1&&angular.forEach(n.columns.filter(function(n){return n.Name!==t}),function(n){n.SortOrder=-1;n.SortDirection="None"}),e=n.columns.filter(function(n){return n.SortOrder>0}),e.sort(function(n,t){return n.SortOrder==t.SortOrder?0:n.SortOrder>t.SortOrder}),e.forEach(function(n,t){n.SortOrder=t+1}),n.$broadcast("tbGrid_OnColumnSorted"),n.retrieveData())};n.selectedRows=function(){var i=t.get(n.name+"_rows");return(i==null||i==="")&&(i=[]),i};n.clearSelection=function(){angular.forEach(n.rows,function(n){n.$selected=!1});t.set(n.name+"_rows",[])};n.isEmptySelection=function(){return n.selectedRows().length===0};n.selectFromSession=function(t){t.$selected=n.selectedRows().filter(function(n){return n.$key===t.$key}).length>0};n.changeSelection=function(i){if(!angular.isUndefined(i)){i.$selected=!i.$selected;var r=n.selectedRows();i.$selected?r.push({$key:i.$key}):r=r.filter(function(n){return n.$key!==i.$key});t.set(n.name+"_rows",r)}};n.getFullDataSource=function(t){n.dataService.retrieveDataAsync({serverUrl:n.serverUrl,requestMethod:n.requestMethod||"POST",timeout:n.requestTimeout,requireAuthentication:n.requireAuthentication,data:{Count:n.requestCounter,Columns:n.columns,Skip:0,Take:-1,Search:{Text:"",Operator:"None"}}}).promise.then(function(n){t(n.Payload)},function(t){n.$emit("tbGrid_OnConnectionError",t)}).then(function(){n.currentRequest=null})};n.visibleColumns=function(){return n.columns.filter(function(n){return n.Visible}).length};n.$emit("tbGrid_OnGreetParentController",n)}]}}]).directive("tbGridTable",[function(){return{require:"^tbGrid",template:'<table ng-transclude class="table tubular-grid-table"><\/table>',restrict:"E",replace:!0,transclude:!0,scope:!0,controller:["$scope",function(n){n.$component=n.$parent.$parent;n.tubularDirective="tubular-grid-table"}]}}]).directive("tbColumnDefinitions",[function(){return{require:"^tbGridTable",template:"<thead><tr ng-transclude><\/tr><\/thead>",restrict:"E",replace:!0,transclude:!0,scope:!0,controller:["$scope",function(n){n.$component=n.$parent.$parent.$component;n.tubularDirective="tubular-column-definitions"}],compile:function(){return{post:function(n){n.$component.hasColumnsDefinitions=!0}}}}}]).directive("tbColumn",["tubularGridColumnModel",function(n){return{require:"^tbColumnDefinitions",template:'<th ng-transclude ng-class="{sortable: column.Sortable}" ng-show="column.Visible"><\/th>',restrict:"E",replace:!0,transclude:!0,scope:{visible:"=",label:"@?"},controller:["$scope",function(n){n.column={Label:""};n.$component=n.$parent.$parent.$component;n.tubularDirective="tubular-column";n.sortColumn=function(t){n.$component.sortColumn(n.column.Name,t)};n.$watch("visible",function(t){angular.isDefined(t)&&(n.column.Visible=t)});n.$watch("label",function(){n.column.Label=n.label;n.$broadcast("tbColumn_LabelChanged",n.label)})}],compile:function(){return{pre:function(t,i,r){r.label=angular.isDefined(r.label)?r.label:(r.name||"").replace(/([a-z])([A-Z])/g,"$1 $2");var u=new n(r);t.$component.addColumn(u);t.column=u;t.label=u.Label}}}}}]).directive("tbColumnHeader",["$compile",function(){return{require:"^tbColumn",template:'<span><a title="Click to sort. Press Ctrl to sort by multiple columns" class="column-header" href ng-click="sortColumn($event)"><span class="column-header-default">{{ $parent.column.Label }}<\/span><span ng-transclude><\/span><\/a> <i class="fa sort-icon" ng-class="{\'fa-long-arrow-up\': $parent.column.SortDirection == \'Ascending\', \'fa-long-arrow-down\': $parent.column.SortDirection == \'Descending\'}">&nbsp;<\/i><\/span>',restrict:"E",replace:!0,transclude:!0,scope:!1,controller:["$scope",function(n){n.sortColumn=function(t){n.$parent.sortColumn(t.ctrlKey)};n.$on("tbColumn_LabelChanged",function(t,i){n.label=i})}],link:function(n,t){t.find("[ng-transclude] *").length>0&&t.find("span.column-header-default").remove();n.$parent.column.Sortable||t.find("a").replaceWith(t.find("a").children())}}}]).directive("tbRowSet",[function(){return{require:"^tbGrid",template:"<tbody ng-transclude><\/tbody>",restrict:"E",replace:!0,transclude:!0,scope:!1,controller:["$scope",function(n){n.$component=n.$parent.$component||n.$parent.$parent.$component;n.tubularDirective="tubular-row-set"}]}}]).directive("tbFootSet",[function(){return{require:"^tbGrid",template:"<tfoot ng-transclude><\/tfoot>",restrict:"E",replace:!0,transclude:!0,scope:!1,controller:["$scope",function(n){n.$component=n.$parent.$component||n.$parent.$parent.$component;n.tubularDirective="tubular-foot-set"}]}}]).directive("tbRowTemplate",[function(){return{template:'<tr ng-transclude ng-class="{\'info\': selectableBool && model.$selected}" ng-click="changeSelection(model)"><\/tr>',restrict:"E",replace:!0,transclude:!0,scope:{model:"=rowModel",selectable:"@"},controller:["$scope",function(n){n.tubularDirective="tubular-rowset";n.fields=[];n.hasFieldsDefinitions=!1;n.selectableBool=n.selectable=="true";n.$component=n.$parent.$parent.$parent.$component;n.$watch("hasFieldsDefinitions",function(t){t!==!0||angular.isUndefined(n.model)||n.bindFields()});n.bindFields=function(){angular.forEach(n.fields,function(n){n.bindScope()})};n.selectableBool&&angular.isDefined(n.model)&&n.$component.selectFromSession(n.model);n.changeSelection=function(t){n.selectableBool&&n.$component.changeSelection(t)}}],compile:function(){return{post:function(n){n.hasFieldsDefinitions=!0}}}}}]).directive("tbCellTemplate",[function(){return{require:"^tbRowTemplate",template:'<td ng-transclude ng-show="column.Visible" data-label="{{::column.Label}}"><\/td>',restrict:"E",replace:!0,transclude:!0,scope:{columnName:"@?"},controller:["$scope",function(n){if(n.column={Visible:!0},n.columnName=n.columnName||null,n.$component=n.$parent.$parent.$component,n.getFormScope=function(){return null},n.columnName!=null){var t=n.$component.columns.filter(function(t){return t.Name===n.columnName});t.length>0&&(n.column=t[0])}}]}}])}(),function(){angular.module("tubular.directives").directive("tbSimpleEditor",["tubularEditorService","$filter",function(n,t){return{template:'<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{value}}<\/span><label ng-show="showLabel">{{ label }}<\/label><input type="{{editorType}}" placeholder="{{placeholder}}" ng-show="isEditing" ng-model="value" class="form-control"  ng-required="required" ng-readonly="readOnly" name="{{name}}" /><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:angular.extend({regex:"@?",regexErrorMessage:"@?"},n.defaultScope),controller:["$scope",function(i){i.validate=function(){if(angular.isDefined(i.regex)&&i.regex!=null&&angular.isDefined(i.value)&&i.value!=null&&i.value!=""){var n=new RegExp(i.regex);if(n.test(i.value)===!1){i.$valid=!1;i.state.$errors=[i.regexErrorMessage||t("translate")("EDITOR_REGEX_DOESNT_MATCH")];return}}if(angular.isDefined(i.match)&&i.match&&i.value!=i.$component.model[i.match]){i.$valid=!1;i.state.$errors=[t("translate")("EDITOR_MATCH",i.match)];return}if(angular.isDefined(i.min)&&angular.isDefined(i.value)&&i.value!=null&&i.value.length<parseInt(i.min)){i.$valid=!1;i.state.$errors=[t("translate")("EDITOR_MIN_CHARS",i.min)];return}if(angular.isDefined(i.max)&&angular.isDefined(i.value)&&i.value!=null&&i.value.length>parseInt(i.max)){i.$valid=!1;i.state.$errors=[t("translate")("EDITOR_MAX_CHARS",i.max)];return}};n.setupScope(i)}]}}]).directive("tbNumericEditor",["tubularEditorService","$filter",function(n,t){return{template:'<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{value | numberorcurrency: format }}<\/span><label ng-show="showLabel">{{ label }}<\/label><div class="input-group" ng-show="isEditing"><div class="input-group-addon" ng-hide="format == \'I\'"><i ng-class="{ \'fa\': true, \'fa-calculator\': format != \'C\', \'fa-usd\': format == \'C\'}"><\/i><\/div><input type="number" placeholder="{{placeholder}}" ng-model="value" class="form-control" ng-required="required" ng-hide="readOnly" step="{{step || \'any\'}}"  name="{{name}}" /><p class="form-control form-control-static text-right" ng-show="readOnly">{{value | numberorcurrency: format}}<\/span><\/p><\/div><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:angular.extend({step:"=?"},n.defaultScope),controller:["$scope",function(i){i.DataType="numeric";i.validate=function(){(angular.isDefined(i.min)&&angular.isDefined(i.value)&&i.value!=null&&(i.$valid=i.value>=i.min,i.$valid||(i.state.$errors=[t("translate")("EDITOR_MIN_NUMBER",i.min)])),i.$valid)&&angular.isDefined(i.max)&&angular.isDefined(i.value)&&i.value!=null&&(i.$valid=i.value<=i.max,i.$valid||(i.state.$errors=[t("translate")("EDITOR_MAX_NUMBER",i.max)]))};n.setupScope(i,0)}]}}]).directive("tbDateTimeEditor",["tubularEditorService",function(n){return{template:'<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{ value | date: format }}<\/span><label ng-show="showLabel">{{ label }}<\/label><input type="datetime-local" ng-show="isEditing" ng-model="value" class="form-control" ng-required="required" ng-readonly="readOnly" name="{{name}}" /><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:n.defaultScope,controller:n.dateEditorController("yyyy-MM-dd HH:mm"),compile:function(){return{post:function(n,t){var i=$(t).find("input[type=datetime-local]")[0];if(i.type!=="datetime-local")$(i).datepicker({dateFormat:n.format.toLowerCase().split(" ")[0]}).datepicker("setDate",n.value).on("dateChange",function(t){n.$apply(function(){n.value=t.date;angular.isDefined(n.$parent.Model)&&(n.$parent.Model.$hasChanges=!0)})})}}}}}]).directive("tbDateEditor",["tubularEditorService",function(n){return{template:'<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{ value | date: format }}<\/span><label ng-show="showLabel">{{ label }}<\/label><input type="date" ng-show="isEditing" ng-model="value" class="form-control" ng-required="required" ng-readonly="readOnly" name="{{name}}"/><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:n.defaultScope,controller:n.dateEditorController("yyyy-MM-dd"),compile:function(){return{post:function(n,t){var i=$(t).find("input[type=date]")[0];if(i.type!=="date")$(i).datepicker({dateFormat:n.format.toLowerCase()}).datepicker("setDate",n.value).on("dateChange",function(t){n.$apply(function(){n.value=t.date;angular.isDefined(n.$parent.Model)&&(n.$parent.Model.$hasChanges=!0)})})}}}}}]).directive("tbDropdownEditor",["tubularEditorService",function(n){return{template:'<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{ value }}<\/span><label ng-show="showLabel">{{ label }}<\/label><select ng-options="{{ selectOptions }}" ng-show="isEditing" ng-model="value" class="form-control" ng-required="required" ng-disabled="readOnly" name="{{name}}" /><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:angular.extend({options:"=?",optionsUrl:"@",optionsMethod:"@?",optionLabel:"@?",optionKey:"@?"},n.defaultScope),controller:["$scope",function(t){n.setupScope(t);t.dataIsLoaded=!1;t.selectOptions="d for d in options";angular.isDefined(t.optionLabel)&&(t.selectOptions="d."+t.optionLabel+" for d in options",angular.isDefined(t.optionKey)&&(t.selectOptions="d."+t.optionKey+" as "+t.selectOptions));t.$watch("value",function(n){t.$emit("tbForm_OnFieldChange",t.$component,t.name,n)});t.loadData=function(){if(!t.dataIsLoaded){if(angular.isUndefined(t.$component)||t.$component==null)throw"You need to define a parent Form or Grid";var n=t.$component.dataService.retrieveDataAsync({serverUrl:t.optionsUrl,requestMethod:t.optionsMethod||"GET"}),i=t.value;t.value="";n.promise.then(function(n){t.options=n;t.dataIsLoaded=!0;var r=t.options&&t.options.length>0?angular.isDefined(t.optionKey)?t.options[0][t.optionKey]:t.options[0]:"";t.value=i||t.defaultValue||r},function(n){t.$emit("tbGrid_OnConnectionError",n)})}};angular.isDefined(t.optionsUrl)&&(t.$watch("optionsUrl",function(){t.dataIsLoaded=!1;t.loadData()}),t.isEditing?t.loadData():t.$watch("isEditing",function(){t.isEditing&&t.loadData()}))}]}}]).directive("tbTypeaheadEditor",["tubularEditorService","$q","$compile",function(n,t,i){return{restrict:"E",replace:!0,transclude:!0,scope:angular.extend({options:"=?",optionsUrl:"@",optionsMethod:"@?",optionLabel:"@?",css:"@?"},n.defaultScope),link:function(n,t){var r='<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{ value }}<\/span><label ng-show="showLabel">{{ label }}<\/label><div class="input-group" ng-show="isEditing"><input ng-model="value" placeholder="{{placeholder}}" title="{{tooltip}}" class="form-control {{css}}" ng-readonly="readOnly || lastSet.indexOf(value) !== -1" uib-typeahead="'+n.selectOptions+'" ng-required="required" name="{{name}}" /> <div class="input-group-addon" ng-hide="lastSet.indexOf(value) !== -1"><i class="fa fa-pencil"><\/i><\/div><span class="input-group-btn" ng-show="lastSet.indexOf(value) !== -1" tabindex="-1"><button class="btn btn-default" type="button" ng-click="value = null"><i class="fa fa-times"><\/i><\/span><\/div><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',u=i(r),f=u(n);t.append(f)},controller:["$scope",function(i){n.setupScope(i);i.selectOptions="d for d in getValues($viewValue)";i.lastSet=[];angular.isDefined(i.optionLabel)&&(i.selectOptions="d as d."+i.optionLabel+" for d in getValues($viewValue)");i.$watch("value",function(n){i.$emit("tbForm_OnFieldChange",i.$component,i.name,n);i.tooltip=n;angular.isDefined(n)&&n!=null&&angular.isDefined(i.optionLabel)&&(i.tooltip=n[i.optionLabel])});i.getValues=function(n){if(angular.isDefined(i.optionsUrl)){if(angular.isUndefined(i.$component)||i.$component==null)throw"You need to define a parent Form or Grid";var r=i.$component.dataService.retrieveDataAsync({serverUrl:i.optionsUrl+"?search="+n,requestMethod:i.optionsMethod||"GET"}).promise;return r.then(function(n){return i.lastSet=n,n}),r}return t(function(n){i.lastSet=i.options;n(i.options)})}}]}}]).directive("tbHiddenField",["tubularEditorService",function(n){return{template:'<input type="hidden" ng-model="value" class="form-control" name="{{name}}"  />',restrict:"E",replace:!0,transclude:!0,scope:n.defaultScope,controller:["$scope",function(t){n.setupScope(t)}]}}]).directive("tbCheckboxField",["tubularEditorService",function(n){return{template:'<div ng-class="{ \'checkbox\' : isEditing, \'has-error\' : !$valid && $dirty() }" class="tubular-checkbox"><span ng-hide="isEditing">{{value ? checkedValue : uncheckedValue}}<\/span><input ng-show="isEditing" type="checkbox" ng-model="value" ng-disabled="readOnly"class="tubular-checkbox" id="{{name}}" name="{{name}}" /> <label ng-show="isEditing" for="{{name}}">{{label}}<\/label><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:angular.extend({checkedValue:"=?",uncheckedValue:"=?"},n.defaultScope),controller:["$scope","$element",function(t){t.required=!1;t.checkedValue=angular.isDefined(t.checkedValue)?t.checkedValue:!0;t.uncheckedValue=angular.isDefined(t.uncheckedValue)?t.uncheckedValue:!1;n.setupScope(t)}]}}]).directive("tbTextArea",["tubularEditorService","$filter",function(n,t){return{template:'<div ng-class="{ \'form-group\' : showLabel && isEditing, \'has-error\' : !$valid && $dirty() }"><span ng-hide="isEditing">{{value}}<\/span><label ng-show="showLabel">{{ label }}<\/label><textarea ng-show="isEditing" placeholder="{{placeholder}}" ng-model="value" class="form-control"  ng-required="required" ng-readonly="readOnly" name="{{name}}"><\/textarea><span class="help-block error-block" ng-show="isEditing" ng-repeat="error in state.$errors">{{error}}<\/span><span class="help-block" ng-show="isEditing && help">{{help}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:n.defaultScope,controller:["$scope",function(i){i.validate=function(){if(angular.isDefined(i.min)&&angular.isDefined(i.value)&&i.value!=null&&i.value.length<parseInt(i.min)){i.$valid=!1;i.state.$errors=[t("translate")("EDITOR_MIN_CHARS",+i.min)];return}if(angular.isDefined(i.max)&&angular.isDefined(i.value)&&i.value!=null&&i.value.length>parseInt(i.max)){i.$valid=!1;i.state.$errors=[t("translate")("EDITOR_MAX_CHARS",+i.max)];return}};n.setupScope(i)}]}}])}(),function(){angular.module("tubular.directives").directive("tbColumnFilterButtons",[function(){return{template:'<div class="text-right"><a class="btn btn-sm btn-success" ng-click="applyFilter()" ng-disabled="filter.Operator == \'None\'">{{\'CAPTION_APPLY\' | translate}}<\/a>&nbsp;<button class="btn btn-sm btn-danger" ng-click="clearFilter()">{{\'CAPTION_CLEAR\' | translate}}<\/button><\/div>',restrict:"E",replace:!0,transclude:!0}}]).directive("tbColumnSelector",[function(){return{template:'<button class="btn btn-sm btn-default" ng-click="openColumnsSelector()">{{\'CAPTION_SELECTCOLUMNS\' | translate}}<\/button><\/div>',restrict:"E",replace:!0,transclude:!0,controller:["$scope","$uibModal",function(n,t){n.$component=n.$parent;n.openColumnsSelector=function(){var i=n.$component.columns,r=t.open({template:'<div class="modal-header"><h3 class="modal-title">{{\'CAPTION_SELECTCOLUMNS\' | translate}}<\/h3><\/div><div class="modal-body"><table class="table table-bordered table-responsive table-striped table-hover table-condensed"><thead><tr><th>Visible?<\/th><th>Name<\/th><th>Grouping?<\/th><\/tr><\/thead><tbody><tr ng-repeat="col in Model"><td><input type="checkbox" ng-model="col.Visible" ng-disabled="col.Visible && isInvalid()" /><\/td><td>{{col.Label}}<\/td><td><input type="checkbox" ng-disabled="true" ng-model="col.IsGrouping" /><\/td><\/tr><\/tbody><\/table><\/div><\/div><div class="modal-footer"><button class="btn btn-warning" ng-click="closePopup()">{{\'CAPTION_CLOSE\' | translate}}<\/button><\/div>',backdropClass:"fullHeight",animation:!1,controller:["$scope",function(n){n.Model=i;n.isInvalid=function(){return n.Model.filter(function(n){return n.Visible}).length===1};n.closePopup=function(){r.close()}}]})}}]}}]).directive("tbColumnFilter",["tubularGridFilterService",function(n){return{require:"^tbColumn",template:'<div class="tubular-column-menu"><button class="btn btn-xs btn-default btn-popover" ng-click="open()" ng-class="{ \'btn-success\': filter.HasFilter }"><i class="fa fa-filter"><\/i><\/button><div style="display: none;"><button type="button" class="close" data-dismiss="modal" ng-click="close()"><span aria-hidden="true">\u00d7<\/span><\/button><h4>{{filterTitle}}<\/h4><form class="tubular-column-filter-form" onsubmit="return false;"><select class="form-control" ng-model="filter.Operator" ng-hide="dataType == \'boolean\'"><\/select>&nbsp;<input class="form-control" type="search" ng-model="filter.Text" autofocus ng-keypress="checkEvent($event)" ng-hide="dataType == \'boolean\'"placeholder="{{\'CAPTION_VALUE\' | translate}}" ng-disabled="filter.Operator == \'None\'" /><div class="text-center" ng-show="dataType == \'boolean\'"><button type="button" class="btn btn-default btn-md" ng-disabled="filter.Text === true" ng-click="filter.Text = true; filter.Operator = \'Equals\';"><i class="fa fa-check"><\/i><\/button>&nbsp;<button type="button" class="btn btn-default btn-md" ng-disabled="filter.Text === false" ng-click="filter.Text = false; filter.Operator = \'Equals\';"><i class="fa fa-times"><\/i><\/button><\/div><input type="search" class="form-control" ng-model="filter.Argument[0]" ng-keypress="checkEvent($event)" ng-show="filter.Operator == \'Between\'" /><hr /><tb-column-filter-buttons><\/tb-column-filter-buttons><\/form><\/div><\/div>',restrict:"E",replace:!0,transclude:!0,scope:!1,compile:function(){return{pre:function(t,i,r){n.applyFilterFuncs(t,i,r)},post:function(t,i,r){n.createFilterModel(t,r)}}}}}]).directive("tbColumnDateTimeFilter",["tubularGridFilterService",function(n){return{require:"^tbColumn",template:'<div ngTransclude class="btn-group tubular-column-menu"><button class="btn btn-xs btn-default btn-popover" ng-click="open()" ng-class="{ \'btn-success\': filter.HasFilter }"><i class="fa fa-filter"><\/i><\/button><div style="display: none;"><button type="button" class="close" data-dismiss="modal" ng-click="close()"><span aria-hidden="true">\u00d7<\/span><\/button><h4>{{filterTitle}}<\/h4><form class="tubular-column-filter-form" onsubmit="return false;"><select class="form-control" ng-model="filter.Operator"><\/select><input type="date" class="form-control" ng-model="filter.Text" ng-keypress="checkEvent($event)" />&nbsp;<input type="date" class="form-control" ng-model="filter.Argument[0]" ng-keypress="checkEvent($event)" ng-show="filter.Operator == \'Between\'" /><hr /><tb-column-filter-buttons><\/tb-column-filter-buttons><\/form><\/div><\/div>',restrict:"E",replace:!0,transclude:!0,scope:!1,controller:["$scope",function(n){n.filter={};n.format="yyyy-MM-dd"}],compile:function(){return{pre:function(t,i,r){n.applyFilterFuncs(t,i,r,function(){var r=$(i).find("input[type=date]")[0],n;if(r.type!=="date")$(r).datepicker({dateFormat:t.format.toLowerCase()}).on("dateChange",function(n){t.filter.Text=n.date});if(n=$(i).find("input[type=date]")[1],n.type!=="date")$(n).datepicker({dateFormat:t.format.toLowerCase()}).on("dateChange",function(n){t.filter.Argument=[n.date]})})},post:function(t,i,r){n.createFilterModel(t,r)}}}}}]).directive("tbColumnOptionsFilter",["tubularGridFilterService",function(n){return{require:"^tbColumn",template:'<div class="tubular-column-menu"><button class="btn btn-xs btn-default btn-popover" ng-click="open()" ng-class="{ \'btn-success\': filter.HasFilter }"><i class="fa fa-filter"><\/i><\/button><div style="display: none;"><button type="button" class="close" data-dismiss="modal" ng-click="close()"><span aria-hidden="true">\u00d7<\/span><\/button><h4>{{::filterTitle}}<\/h4><form class="tubular-column-filter-form" onsubmit="return false;"><select class="form-control checkbox-list" ng-model="filter.Argument" ng-options="item for item in optionsItems"  multiple ng-disabled="dataIsLoaded == false"><\/select><hr /><tb-column-filter-buttons><\/tb-column-filter-buttons><\/form><\/div><\/div>',restrict:"E",replace:!0,transclude:!0,scope:!1,controller:["$scope",function(n){n.dataIsLoaded=!1;n.getOptionsFromUrl=function(){if(n.dataIsLoaded){n.$apply();return}var t=n.$component.dataService.retrieveDataAsync({serverUrl:n.filter.OptionsUrl,requestMethod:"GET"});t.promise.then(function(t){n.optionsItems=t;n.dataIsLoaded=!0},function(t){n.$emit("tbGrid_OnConnectionError",t)})}}],compile:function(){return{pre:function(t,i,r){n.applyFilterFuncs(t,i,r,function(){t.getOptionsFromUrl()})},post:function(t,i,r){n.createFilterModel(t,r);t.filter.Operator="Multiple"}}}}}])}(),function(){angular.module("tubular.directives").directive("tbForm",["tubularEditorService",function(n){return{template:function(t,i){var r=i.name||n.getUniqueTbFormName();return'<form ng-transclude name="'+r+'"><\/form>'},restrict:"E",replace:!0,transclude:!0,scope:{model:"=?",serverUrl:"@",serverSaveUrl:"@",serverSaveMethod:"@",isNew:"=",modelKey:"@?",dataServiceName:"@?serviceName",requireAuthentication:"=?",name:"@?formName"},controller:["$scope","$routeParams","tubularModel","tubularHttp","$timeout","$element",function(n,t,i,r,u,f){n.tubularDirective="tubular-form";n.serverSaveMethod=n.serverSaveMethod||"POST";n.fields=[];n.hasFieldsDefinitions=!1;n.dataService=r.getDataService(n.dataServiceName);n.getFormScope=function(){return n[f.attr("name")]};n.requireAuthentication=angular.isUndefined(n.requireAuthentication)?!0:n.requireAuthentication;r.setRequireAuthentication(n.requireAuthentication);n.$watch("hasFieldsDefinitions",function(t){t===!0&&n.retrieveData()});n.cloneModel=function(t){var r={};angular.forEach(t,function(n,t){t[0]!=="$"&&(r[t]=n)});n.model=new i(n,r,n.dataService);n.bindFields()};n.bindFields=function(){angular.forEach(n.fields,function(n){n.bindScope()})};n.retrieveData=function(){if(n.modelKey=n.modelKey||t.param,angular.isDefined(n.serverUrl)){angular.isDefined(n.modelKey)&&n.modelKey!=null&&n.modelKey!==""?n.dataService.getByKey(n.serverUrl,n.modelKey).promise.then(function(t){n.model=new i(n,t,n.dataService);n.bindFields()},function(t){n.$emit("tbForm_OnConnectionError",t)}):n.dataService.get(r.addTimeZoneToUrl(n.serverUrl)).promise.then(function(t){var r=n,u=n.dataService;angular.isDefined(n.model)&&angular.isDefined(n.model.$component)&&(r=n.model.$component,u=n.model.$component.dataService);n.model=new i(r,t,u);n.bindFields();n.model.$isNew=!0},function(t){n.$emit("tbForm_OnConnectionError",t)});return}angular.isUndefined(n.model)&&(n.model=new i(n,{},n.dataService));n.bindFields()};n.save=function(t){if(n.model.$valid()){if(n.currentRequest=n.model.save(t),n.currentRequest===!1){n.$emit("tbForm_OnSavingNoChanges",n);return}n.currentRequest.then(function(t){angular.isDefined(n.model.$component)&&angular.isDefined(n.model.$component.autoRefresh)&&n.model.$component.autoRefresh&&n.model.$component.retrieveData();n.$emit("tbForm_OnSuccessfulSave",t,n)},function(t){n.$emit("tbForm_OnConnectionError",t,n)}).then(function(){n.model.$isLoading=!1;n.currentRequest=null})}};n.update=function(t){n.save(t)};n.create=function(){n.model.$isNew=!0;n.save()};n.cancel=function(){n.$emit("tbForm_OnCancel",n.model)};n.clear=function(){angular.forEach(n.fields,function(n){n.resetEditor?n.resetEditor():n.value=n.defaultValue})};n.finishDefinition=function(){var t=u(function(){n.hasFieldsDefinitions=!0;f.find("input").length&&f.find("input")[0].focus()},0);n.$emit("tbForm_OnGreetParentController",n);n.$on("$destroy",function(){u.cancel(t)})}}],compile:function(){return{post:function(n){n.finishDefinition()}}}}}])}(),function(){angular.module("tubular.directives").directive("tbTextSearch",[function(){return{require:"^tbGrid",template:'<div class="tubular-grid-search"><div class="input-group input-group-sm"><span class="input-group-addon"><i class="fa fa-search"><\/i><\/span><input type="search" class="form-control" placeholder="{{:: placeholder || (\'UI_SEARCH\' | translate) }}" maxlength="20" ng-model="$component.search.Text" ng-model-options="{ debounce: 300 }"><span class="input-group-btn" ng-show="$component.search.Text.length > 0"><button class="btn btn-default" uib-tooltip="{{\'CAPTION_CLEAR\' | translate}}" ng-click="$component.search.Text = \'\'"><i class="fa fa-times-circle"><\/i><\/button><\/span><div><div>',restrict:"E",replace:!0,transclude:!1,scope:{minChars:"@?",placeholder:"@"},terminal:!1,controller:["$scope",function(n){n.$component=n.$parent.$parent;n.minChars=n.minChars||3;n.tubularDirective="tubular-grid-text-search";n.lastSearch=n.$component.search.Text;n.$watch("$component.search.Text",function(t,i){if(!angular.isUndefined(t)&&t!==i){if(n.lastSearch!==""&&t===""){n.$component.saveSearch();n.$component.search.Operator="None";n.$component.retrieveData();return}t===""||t.length<n.minChars||t!==n.lastSearch&&(n.lastSearch=t,n.$component.saveSearch(),n.$component.search.Operator="Auto",n.$component.retrieveData())}})}]}}]).directive("tbRemoveButton",["$compile",function(n){return{require:"^tbGrid",template:'<button ng-click="confirmDelete()" class="btn" ng-hide="model.$isEditing"><span ng-show="showIcon" class="{{::icon}}"><\/span><span ng-show="showCaption">{{:: caption || (\'CAPTION_REMOVE\' | translate) }}<\/span><\/button>',restrict:"E",replace:!0,transclude:!0,scope:{model:"=",caption:"@",cancelCaption:"@",legend:"@",icon:"@"},controller:["$scope","$element","$filter",function(t,i,r){t.showIcon=angular.isDefined(t.icon);t.showCaption=!(t.showIcon&&angular.isUndefined(t.caption));t.confirmDelete=function(){i.popover({html:!0,title:t.legend||r("translate")("UI_REMOVEROW"),content:function(){var i='<div class="tubular-remove-popover"><button ng-click="model.delete()" class="btn btn-danger btn-xs">'+(t.caption||r("translate")("CAPTION_REMOVE"))+'<\/button>&nbsp;<button ng-click="cancelDelete()" class="btn btn-default btn-xs">'+(t.cancelCaption||r("translate")("CAPTION_CANCEL"))+"<\/button><\/div>";return n(i)(t)}});i.popover("show")};t.cancelDelete=function(){i.popover("destroy")}}]}}]).directive("tbSaveButton",[function(){return{require:"^tbGrid",template:'<div ng-show="model.$isEditing"><button ng-click="save()" class="btn btn-default {{:: saveCss || \'\' }}" ng-disabled="!model.$valid()">{{:: saveCaption || (\'CAPTION_SAVE\' | translate) }}<\/button><button ng-click="cancel()" class="btn {{:: cancelCss || \'btn-default\' }}">{{:: cancelCaption || (\'CAPTION_CANCEL\' | translate) }}<\/button><\/div>',restrict:"E",replace:!0,transclude:!0,scope:{model:"=",isNew:"=?",saveCaption:"@",saveCss:"@",cancelCaption:"@",cancelCss:"@"},controller:["$scope",function(n){n.isNew=n.isNew||!1;n.save=function(){if(n.isNew&&(n.model.$isNew=!0),n.model.$valid()){if(n.currentRequest=n.model.save(),n.currentRequest===!1){n.$emit("tbGrid_OnSavingNoChanges",n.model);return}n.currentRequest.then(function(t){n.model.$isEditing=!1;angular.isDefined(n.model.$component)&&angular.isDefined(n.model.$component.autoRefresh)&&n.model.$component.autoRefresh&&n.model.$component.retrieveData();n.$emit("tbGrid_OnSuccessfulSave",t,n.model.$component)},function(t){n.$emit("tbGrid_OnConnectionError",t)})}};n.cancel=function(){n.model.revertChanges()}}]}}]).directive("tbEditButton",[function(){return{require:"^tbGrid",template:'<button ng-click="edit()" class="btn btn-default" ng-hide="model.$isEditing">{{:: caption || (\'CAPTION_EDIT\' | translate) }}<\/button>',restrict:"E",replace:!0,transclude:!0,scope:{model:"=",caption:"@"},controller:["$scope",function(n){n.component=n.$parent.$parent.$component;n.edit=function(){n.component.editorMode==="popup"?n.model.editPopup():n.model.edit()}}]}}]).directive("tbPageSizeSelector",[function(){return{require:"^tbGrid",template:'<div class="{{::css}}"><form class="form-inline"><div class="form-group"><label class="small">{{:: caption || (\'UI_PAGESIZE\' | translate) }} <\/label>&nbsp;<select ng-model="$parent.$parent.pageSize" class="form-control input-sm {{::selectorCss}}" ng-options="item for item in options"><\/select><\/div><\/form><\/div>',restrict:"E",replace:!0,transclude:!0,scope:{caption:"@",css:"@",selectorCss:"@",options:"=?"},controller:["$scope",function(n){n.options=angular.isDefined(n.options)?n.options:[10,20,50,100]}]}}]).directive("tbExportButton",[function(){return{require:"^tbGrid",template:'<div class="btn-group"><button class="btn btn-default dropdown-toggle {{::css}}" data-toggle="dropdown" aria-expanded="false"><span class="fa fa-download"><\/span>&nbsp;{{:: caption || (\'UI_EXPORTCSV\' | translate)}}&nbsp;<span class="caret"><\/span><\/button><ul class="dropdown-menu" role="menu"><li><a href="javascript:void(0)" ng-click="downloadCsv($parent)">{{:: captionMenuCurrent || (\'UI_CURRENTROWS\' | translate)}}<\/a><\/li><li><a href="javascript:void(0)" ng-click="downloadAllCsv($parent)">{{:: captionMenuAll || (\'UI_ALLROWS\' | translate)}}<\/a><\/li><\/ul><\/div>',restrict:"E",replace:!0,transclude:!0,scope:{filename:"@",css:"@",caption:"@",captionMenuCurrent:"@",captionMenuAll:"@"},controller:["$scope","tubularGridExportService",function(n,t){n.$component=n.$parent.$parent;n.downloadCsv=function(){t.exportGridToCsv(n.filename,n.$component)};n.downloadAllCsv=function(){t.exportAllGridToCsv(n.filename,n.$component)}}]}}]).directive("tbPrintButton",[function(){return{require:"^tbGrid",template:'<button class="btn btn-default" ng-click="printGrid()"><span class="fa fa-print"><\/span>&nbsp;{{caption || (\'CAPTION_PRINT\' | translate)}}<\/button>',restrict:"E",replace:!0,transclude:!0,scope:{title:"@",printCss:"@",caption:"@"},controller:["$scope",function(n){n.$component=n.$parent.$parent;n.printGrid=function(){n.$component.getFullDataSource(function(t){var r="<table class='table table-bordered table-striped'><thead><tr>"+n.$component.columns.filter(function(n){return n.Visible}).map(function(n){return"<th>"+(n.Label||n.Name)+"<\/th>"}).join(" ")+"<\/tr><\/thead><tbody>"+t.map(function(t){return typeof t=="object"&&(t=$.map(t,function(n){return n})),"<tr>"+t.map(function(t,i){return angular.isDefined(n.$component.columns[i])&&!n.$component.columns[i].Visible?"":"<td>"+t+"<\/td>"}).join(" ")+"<\/tr>"}).join(" ")+"<\/tbody><\/table>",i=window.open("about:blank","Print","menubar=0,location=0,height=500,width=800");i.document.write('<link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap/latest/css/bootstrap.min.css" />');n.printCss!=""&&i.document.write('<link rel="stylesheet" href="'+n.printCss+'" />');i.document.write('<body onload="window.print();">');i.document.write("<h1>"+n.title+"<\/h1>");i.document.write(r);i.document.write("<\/body>");i.document.close()})}}]}}])}(),function(){angular.module("tubular.directives").directive("tbGridPager",["$timeout",function(n){return{require:"^tbGrid",template:'<div class="tubular-pager"><uib-pagination ng-disabled="$component.isEmpty" direction-links="true" boundary-links="true" total-items="$component.filteredRecordCount" items-per-page="$component.pageSize" max-size="5" ng-model="$component.currentPage" ng-change="pagerPageChanged()"><\/uib-pagination><div>',restrict:"E",replace:!0,transclude:!1,scope:!0,terminal:!1,controller:["$scope","$element",function(n,t){n.$component=n.$parent.$parent;n.tubularDirective="tubular-grid-pager";n.$watch("$component.currentPage",function(){n.$component.currentPage!=n.$component.requestedPage&&(n.$component.requestedPage=n.$component.currentPage)});n.pagerPageChanged=function(){n.$component.requestedPage=n.$component.currentPage;var i=t.find("li a");$(i).blur()}}],compile:function(){return{post:function(t,i,r){t.firstButtonClass=r.firstButtonClass||"fa fa-fast-backward";t.prevButtonClass=r.prevButtonClass||"fa fa-backward";t.nextButtonClass=r.nextButtonClass||"fa fa-forward";t.lastButtonClass=r.lastButtonClass||"fa fa-fast-forward";var u=n(function(){var n=i.find("li a");$(n[0]).html('<i class="'+t.firstButtonClass+'"><\/i>');$(n[1]).html('<i class="'+t.prevButtonClass+'"><\/i>');$(n[n.length-2]).html('<i class="'+t.nextButtonClass+'"><\/i>');$(n[n.length-1]).html('<i class="'+t.lastButtonClass+'"><\/i>')},0);t.$on("$destroy",function(){n.cancel(u)})}}}}}]).directive("tbGridPagerInfo",[function(){return{require:"^tbGrid",template:'<div class="pager-info small" ng-hide="$component.isEmpty">{{\'UI_SHOWINGRECORDS\' | translate: currentInitial:currentTop:$component.filteredRecordCount}} <span ng-show="filtered">{{\'UI_FILTEREDRECORDS\' | translate: $component.totalRecordCount}}<\/span><\/div>',restrict:"E",replace:!0,transclude:!0,scope:!0,controller:["$scope",function(n){n.$component=n.$parent.$parent;n.fixCurrentTop=function(){n.currentTop=n.$component.pageSize*n.$component.currentPage;n.currentInitial=(n.$component.currentPage-1)*n.$component.pageSize+1;n.currentTop>n.$component.filteredRecordCount&&(n.currentTop=n.$component.filteredRecordCount);n.currentTop<0&&(n.currentTop=0);(n.currentInitial<0||n.$component.totalRecordCount===0)&&(n.currentInitial=0)};n.$component.$watch("filteredRecordCount",function(){n.filtered=n.$component.totalRecordCount!=n.$component.filteredRecordCount;n.fixCurrentTop()});n.$component.$watch("currentPage",function(){n.fixCurrentTop()});n.$component.$watch("pageSize",function(){n.fixCurrentTop()});n.fixCurrentTop()}]}}])}(),function(){angular.module("tubular.models",[]).factory("tubularGridColumnModel",["$filter",function(n){var t=function(n){return angular.isUndefined(n)?"None":n.toLowerCase().indexOf("asc")===0?"Ascending":n.toLowerCase().indexOf("desc")===0?"Descending":"None"};return function(i){this.Name=i.name||null;this.Label=i.label||null;this.Sortable=i.sortable==="true";this.SortOrder=parseInt(i.sortOrder)||-1;this.SortDirection=t(i.sortDirection);this.IsKey=i.isKey==="true";this.Searchable=i.searchable==="true";this.Visible=i.visible==="false"?!1:!0;this.Filter=null;this.DataType=i.columnType||"string";this.IsGrouping=i.isGrouping==="true";this.Aggregate=i.aggregate||"none";this.MetaAggregate=i.metaAggregate||"none";this.FilterOperators={string:{None:n("translate")("OP_NONE"),Equals:n("translate")("OP_EQUALS"),NotEquals:n("translate")("OP_NOTEQUALS"),Contains:n("translate")("OP_CONTAINS"),NotContains:n("translate")("OP_NOTCONTAINS"),StartsWith:n("translate")("OP_STARTSWITH"),NotStartsWith:n("translate")("OP_NOTSTARTSWITH"),EndsWith:n("translate")("OP_ENDSWITH"),NotEndsWith:n("translate")("OP_NOTENDSWITH")},numeric:{None:n("translate")("OP_NONE"),Equals:n("translate")("OP_EQUALS"),Between:n("translate")("OP_BETWEEN"),Gte:">=",Gt:">",Lte:"<=",Lt:"<"},date:{None:n("translate")("OP_NONE"),Equals:n("translate")("OP_EQUALS"),NotEquals:n("translate")("OP_NOTEQUALS"),Between:n("translate")("OP_BETWEEN"),Gte:">=",Gt:">",Lte:"<=",Lt:"<"},datetime:{None:n("translate")("OP_NONE"),Equals:n("translate")("OP_EQUALS"),NotEquals:n("translate")("OP_NOTEQUALS"),Between:n("translate")("OP_BETWEEN"),Gte:">=",Gt:">",Lte:"<=",Lt:"<"},datetimeutc:{None:n("translate")("OP_NONE"),Equals:n("translate")("OP_EQUALS"),NotEquals:n("translate")("OP_NOTEQUALS"),Between:n("translate")("OP_BETWEEN"),Gte:">=",Gt:">",Lte:"<=",Lt:"<"},boolean:{None:n("translate")("OP_NONE"),Equals:n("translate")("OP_EQUALS"),NotEquals:n("translate")("OP_NOTEQUALS")}}}}]).factory("tubularGridFilterModel",function(){return function(n){this.Text=n.text||null;this.Argument=null;n.argument&&(this.Argument=[n.argument]);this.Operator=n.operator||"Contains";this.OptionsUrl=n.optionsUrl||null;this.HasFilter=!(this.Text==null)}}).factory("tubularModel",function(){return function(n,t,i){var r={$key:"",$addField:function(t,i,u){this[t]=i;angular.isUndefined(this.$original)&&(this.$original={});this.$original[t]=u?undefined:i;u&&(this.$hasChanges=!0);angular.isUndefined(this.$state)&&(this.$state={});n.$watch(function(){return r[t]},function(n,i){n!==i&&(r.$hasChanges=r[t]!==r.$original[t])})}};return angular.isArray(t)===!1&&angular.forEach(Object.keys(t),function(n){r.$addField(n,t[n])}),angular.isDefined(n.columns)&&angular.forEach(n.columns,function(n,i){var e=t[i]||t[n.Name],f,u;angular.isUndefined(e)&&t[i]===0&&(e=0);r.$addField(n.Name,e);(n.DataType==="date"||n.DataType==="datetime"||n.DataType==="datetimeutc")&&(f=(new Date).toString().match(/([-\+][0-9]+)\s/)[1],f=f.substr(0,f.length-2)+":"+f.substr(f.length-2,2),u=new Date(Date.parse(r[n.Name]+f)),r[n.Name]=n.DataType==="date"?new Date(1900+u.getYear(),u.getMonth(),u.getDate()):new Date(1900+u.getYear(),u.getMonth(),u.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),0));n.IsKey&&(r.$key+=r[n.Name]+",")}),r.$key.length>1&&(r.$key=r.$key.substring(0,r.$key.length-1)),r.$isEditing=!1,r.$hasChanges=!1,r.$selected=!1,r.$isNew=!1,r.$valid=function(){var t,n;for(t in r.$state)if(r.$state.hasOwnProperty(t)){if(n=t,angular.isUndefined(r.$state[n])||r.$state[n]==null||angular.isUndefined(r.$state[n].$valid))continue;if(r.$state[n].$valid()&&r.$state[n].$dirty)continue;return!1}return!0},r.save=function(t){if(angular.isUndefined(i)||i==null)throw"Define DataService to your model.";if(angular.isUndefined(n.serverSaveUrl)||n.serverSaveUrl==null)throw"Define a Save URL.";return!t&&!r.$isNew&&!r.$hasChanges?!1:(r.$isLoading=!0,i.saveDataAsync(r,{serverUrl:n.serverSaveUrl,requestMethod:r.$isNew?n.serverSaveMethod||"POST":"PUT"}).promise)},r.edit=function(){r.$isEditing&&r.$hasChanges&&r.save();r.$isEditing=!r.$isEditing},r.delete=function(){n.deleteRow(r)},r.resetOriginal=function(){for(var n in r.$original)r.$original.hasOwnProperty(n)&&(r.$original[n]=r[n])},r.revertChanges=function(){for(var n in r)if(r.hasOwnProperty(n)){if(n[0]==="$"||angular.isUndefined(r.$original[n]))continue;r[n]=r.$original[n]}r.$isEditing=!1;r.$hasChanges=!1},r}})}(),function(){angular.module("tubular.services",["ui.bootstrap"]).service("tubularPopupService",["$uibModal","$rootScope","tubularTemplateService",function(n,t,i){var r=this;r.onSuccessForm=function(n){t.$on("tbForm_OnSuccessfulSave",n)};r.onConnectionError=function(n){t.$on("tbForm_OnConnectionError",n)};r.openDialog=function(r,u,f,e){angular.isUndefined(r)&&(r=i.generatePopup(u));var o=n.open({templateUrl:r,backdropClass:"fullHeight",animation:!1,size:e,controller:["$scope",function(n){n.Model=u;n.savePopup=function(i,r){if(i=i||n.Model,!r&&!i.$isNew&&!i.$hasChanges)return n.closePopup(),null;var u=i.save(r);return angular.isUndefined(u)||u===!1?null:(u.then(function(i){return n.$emit("tbForm_OnSuccessfulSave",i),t.$broadcast("tbForm_OnSuccessfulSave",i),n.Model.$isLoading=!1,f.autoRefresh&&f.retrieveData(),o.close(),i},function(i){return n.$emit("tbForm_OnConnectionError",i),t.$broadcast("tbForm_OnConnectionError",i),n.Model.$isLoading=!1,i}),u)};n.closePopup=function(){angular.isDefined(n.Model.revertChanges)&&n.Model.revertChanges();o.close()}}]});return o}}]).service("tubularGridExportService",function(){var n=this;n.getColumns=function(n){return n.columns.map(function(n){return n.Label})};n.getColumnsVisibility=function(n){return n.columns.map(function(n){return n.Visible})};n.exportAllGridToCsv=function(t,i){var r=n.getColumns(i),u=n.getColumnsVisibility(i);i.getFullDataSource(function(i){n.exportToCsv(t,r,i,u)})};n.exportGridToCsv=function(t,i){var r=n.getColumns(i),u=n.getColumnsVisibility(i);i.currentRequest={};n.exportToCsv(t,r,i.dataSource.Payload,u);i.currentRequest=null};n.exportToCsv=function(n,t,i,r){var e=function(n){var u,t,f,i;for(typeof n=="object"&&(n=Object.keys(n).map(function(t){return n[t]})),u="",t=0;t<n.length;t++)r[t]&&(f=n[t]==null?"":n[t].toString(),n[t]instanceof Date&&(f=n[t].toLocaleString()),i=f.replace(/"/g,'""'),i.search(/("|,|\n)/g)>=0&&(i='"'+i+'"'),t>0&&(u+=","),u+=i);return u+"\n"},f="",u,o;for(t.length>0&&(f+=e(t)),u=0;u<i.length;u++)f+=e(i[u]);o=new Blob(["\ufeff"+f],{type:"text/csv;charset=utf-8;"});window.saveAs(o,n)}}).service("tubularGridFilterService",["tubularGridFilterModel","$compile","$filter",function(n,t,i){var r=this;r.applyFilterFuncs=function(n,i,r,u){n.$component=n.$parent.$component;n.$watch("filter.Operator",function(t){t==="None"&&(n.filter.Text="")});n.$watch(function(){var t=n.$component.columns.filter(function(t){return t.Name===n.filter.Name});return t.length!==0?t[0]:null},function(t){t&&t!=null&&n.filter.HasFilter!=t.Filter.HasFilter&&(n.filter.HasFilter=t.Filter.HasFilter,n.filter.Text=t.Filter.Text,n.retrieveData())},!0);n.retrieveData=function(){var t=n.$component.columns.filter(function(t){return t.Name===n.filter.Name});t.length!==0&&(t[0].Filter=n.filter);n.$component.retrieveData();n.close()};n.clearFilter=function(){n.filter.Operator!="Multiple"&&(n.filter.Operator="None");n.filter.Text="";n.filter.Argument=[];n.filter.HasFilter=!1;n.retrieveData()};n.applyFilter=function(){n.filter.HasFilter=!0;n.retrieveData()};n.close=function(){$(i).find(".btn-popover").popover("hide")};n.open=function(){$(i).find(".btn-popover").popover("toggle")};n.checkEvent=function(t){t.which===13&&(n.applyFilter(),t.preventDefault())};$(i).find(".btn-popover").popover({html:!0,placement:"bottom",trigger:"manual",content:function(){var i=$(this).next().find("select").find("option").remove().end();return angular.forEach(n.filterOperators,function(n,t){$(i).append('<option value="'+t+'">'+n+"<\/option>")}),t($(this).next().html())(n)}});$(i).find(".btn-popover").on("show.bs.popover",function(n){$(".btn-popover").not(n.target).popover("hide")});if(angular.isDefined(u))$(i).find(".btn-popover").on("shown.bs.popover",u)};r.createFilterModel=function(t,r){t.filter=new n(r);t.filter.Name=t.$parent.column.Name;var u=t.$component.columns.filter(function(n){return n.Name===t.filter.Name});u.length!==0&&(t.$watch("filter",function(n){u[0].Filter.Text!=n.Text&&(n.Text=u[0].Filter.Text,u[0].Filter.Operator!=n.Operator&&(n.Operator=u[0].Filter.Operator));t.filter.HasFilter=u[0].Filter.HasFilter}),u[0].Filter=t.filter,t.dataType=u[0].DataType,t.filterOperators=u[0].FilterOperators[t.dataType],(t.dataType==="date"||t.dataType==="datetime"||t.dataType==="datetimeutc")&&(t.filter.Argument=[new Date],t.filter.Operator==="Contains"&&(t.filter.Operator="Equals")),(t.dataType==="numeric"||t.dataType==="boolean")&&(t.filter.Argument=[1],t.filter.Operator==="Contains"&&(t.filter.Operator="Equals")),t.filterTitle=r.title||i("translate")("CAPTION_FILTER"))}}]).service("tubularEditorService",["$filter",function(n){var t=this;t.defaultScope={value:"=?",isEditing:"=?",editorType:"@",showLabel:"=?",label:"@?",required:"=?",format:"@?",min:"=?",max:"=?",name:"@",placeholder:"@?",readOnly:"=?",help:"@?",defaultValue:"@?",match:"@?"};t.dateEditorController=function(i){return["$scope",function(r){r.DataType="date";r.$watch("value",function(n){typeof n=="string"&&(r.value=new Date(n))});r.validate=function(){(angular.isDefined(r.min)&&(Object.prototype.toString.call(r.min)!=="[object Date]"&&(r.min=new Date(r.min)),r.$valid=r.value>=r.min,r.$valid||(r.state.$errors=[n("translate")("EDITOR_MIN_DATE",n("date")(r.min,r.format))])),r.$valid)&&angular.isDefined(r.max)&&(Object.prototype.toString.call(r.max)!=="[object Date]"&&(r.max=new Date(r.max)),r.$valid=r.value<=r.max,r.$valid||(r.state.$errors=[n("translate")("EDITOR_MAX_DATE",n("date")(r.max,r.format))]))};t.setupScope(r,i)}]};t.getUniqueTbFormName=function(){return window.tbFormCounter=window.tbFormCounter||(window.tbFormCounter=-1),window.tbFormCounter++,"tbForm"+window.tbFormCounter};t.setupScope=function(t,i){t.isEditing=angular.isUndefined(t.isEditing)?!0:t.isEditing;t.showLabel=t.showLabel||!1;t.label=t.label||(t.name||"").replace(/([a-z])([A-Z])/g,"$1 $2");t.required=t.required||!1;t.readOnly=t.readOnly||!1;t.format=t.format||i;t.$valid=!0;t.getFormField=function(){for(var n=t.$parent,i;;){if(n==null)break;if(angular.isDefined(n.tubularDirective)&&n.tubularDirective==="tubular-form")return i=n.getFormScope(),i==null?null:i[t.Name];n=n.$parent}};t.$dirty=function(){var n=t.getFormField();return n==null?!0:n.$dirty};t.checkValid=function(){if(t.$valid=!0,t.state.$errors=[],angular.isUndefined(t.value)&&t.required||Object.prototype.toString.call(t.value)==="[object Date]"&&isNaN(t.value.getTime())&&t.required){t.$valid=!1;t.$dirty()&&(t.state.$errors=[n("translate")("EDITOR_REQUIRED")]);angular.isDefined(t.$parent.Model)&&(t.$parent.Model.$state[t.Name]=t.state);return}angular.isUndefined(t.validate)||t.validate()};t.$watch("label",function(n){angular.isUndefined(n)&&(t.label=(t.name||"").replace(/([a-z])([A-Z])/g,"$1 $2"))});t.$watch("value",function(n,i){angular.isUndefined(i)&&angular.isUndefined(n)||(t.state={$valid:function(){return t.checkValid(),this.$errors.length===0},$dirty:function(){return t.$dirty},$errors:[]},t.$valid=!0,angular.isDefined(t.$parent.Model)&&(angular.isDefined(t.$parent.Model[t.name])?(t.$parent.Model[t.name]=n,angular.isUndefined(t.$parent.Model.$state)&&(t.$parent.Model.$state=[]),t.$parent.Model.$state[t.Name]=t.state):angular.isDefined(t.$parent.Model.$addField)&&t.$parent.Model.$addField(t.name,n,!0)),t.checkValid())});for(var r=t.$parent;;){if(r==null)break;if(angular.isDefined(r.tubularDirective)&&(r.tubularDirective==="tubular-form"||r.tubularDirective==="tubular-rowset")){if(t.name===null)return;if(r.hasFieldsDefinitions!==!1)throw"Cannot define more fields. Field definitions have been sealed";t.$component=r.tubularDirective==="tubular-form"?r:r.$component;t.Name=t.name;t.bindScope=function(){t.$parent.Model=r.model;angular.equals(t.value,r.model[t.Name])===!1&&(angular.isDefined(r.model[t.Name])&&(t.value=t.DataType==="date"&&r.model[t.Name]!=null?new Date(r.model[t.Name]):r.model[t.Name]),r.$watch(function(){return t.value},function(n){r.model[t.Name]=n}));(!t.value||t.value==null)&&t.defaultValue&&t.defaultValue!=null&&(t.DataType==="date"&&t.defaultValue!=null&&(t.defaultValue=new Date(t.defaultValue)),t.DataType==="numeric"&&t.defaultValue!=null&&(t.defaultValue=parseFloat(t.defaultValue)),t.value=t.defaultValue);angular.isUndefined(r.model.$state)&&(r.model.$state={});r.model.$state[t.Name]={$valid:function(){return t.checkValid(),this.$errors.length===0},$dirty:function(){return t.$dirty},$errors:[]};angular.equals(t.state,r.model.$state[t.Name])===!1&&(t.state=r.model.$state[t.Name])};r.fields.push(t);break}r=r.$parent}}}])}(),function(){angular.module("tubular.services").service("tubularHttp",["$http","$timeout","$q","$cacheFactory","localStorageService","$filter",function(n,t,i,r,u,f){function o(n){var t=new Date;return n=new Date(n),n-t<=0}function s(){u.remove("auth_data")}function c(){s();u.set("auth_data",e.userData)}function h(){n.defaults.headers.common.Authorization="Bearer "+e.userData.bearerToken}function l(){var n=u.get("auth_data");if(typeof n=="undefined"||n==null)throw"No authentication data exists";else if(o(n.expirationDate))throw"Authentication token has already expired";else e.userData=n,h()}function a(){e.userData.isAuthenticated=!1;e.userData.username="";e.userData.bearerToken="";e.userData.expirationDate=null}var e=this;e.userData={isAuthenticated:!1,username:"",bearerToken:"",expirationDate:null};e.cache=r("tubularHttpCache");e.useCache=!0;e.requireAuthentication=!0;e.tokenUrl="/api/token";e.refreshTokenUrl="/api/token";e.setTokenUrl=function(n){e.tokenUrl=n};e.isAuthenticated=function(){if(!e.userData.isAuthenticated||o(e.userData.expirationDate))try{l()}catch(n){return!1}return!0};e.setRequireAuthentication=function(n){e.requireAuthentication=n};e.removeAuthentication=function(){s();a();n.defaults.headers.common.Authorization=null};e.authenticate=function(t,i,r,u,f,o){this.removeAuthentication();n({method:"POST",url:e.tokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"grant_type=password&username="+t+"&password="+i}).success(function(n){e.handleSuccessCallback(o,r,f,n)}).error(function(n){e.handleErrorCallback(u,n)})};e.handleSuccessCallback=function(n,t,i,r){e.userData.isAuthenticated=!0;e.userData.username=r.userName||username;e.userData.bearerToken=r.access_token;e.userData.expirationDate=new Date;e.userData.expirationDate=new Date(e.userData.expirationDate.getTime()+r.expires_in*1e3);e.userData.role=r.role;e.userData.refreshToken=r.refresh_token;typeof n=="function"&&n(r);h();i&&c();typeof t=="function"&&t()};e.handleErrorCallback=function(n,t){typeof n=="function"&&(t.error_description?n(t.error_description):n(f("translate")("UI_HTTPERROR")))};e.addTimeZoneToUrl=function(n){var t=n.indexOf("?")===-1?"?":"&";return n+t+"timezoneOffset="+(new Date).getTimezoneOffset()};e.saveDataAsync=function(n,t){var f=n.$component,i,u,r;return n.$component=null,i=angular.copy(n),n.$component=f,u=angular.copy(n.$original),delete i.$isEditing,delete i.$hasChanges,delete i.$selected,delete i.$original,delete i.$state,delete i.$valid,delete i.$component,delete i.$isLoading,delete i.$isNew,n.$isNew?(t.serverUrl=e.addTimeZoneToUrl(t.serverUrl),t.data=i):t.data={Old:u,New:i,TimezoneOffset:(new Date).getTimezoneOffset()},r=e.retrieveDataAsync(t),r.promise.then(function(t){return n.$hasChanges=!1,n.resetOriginal(),t}),r};e.getExpirationDate=function(){var n=new Date;return new Date(n.getTime()+3e5)};e.refreshSession=function(t,i){n({method:"POST",url:e.refreshTokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"grant_type=refresh_token&refresh_token="+e.userData.refreshToken}).success(function(n){e.handleSuccessCallback(null,null,t,n)}).error(function(n){e.handleErrorCallback(i,n)})};e.checksum=function(n){for(var u=Object.keys(n).sort(),t=[],i,r=0;r<u.length;r++)i=u[r],t.push(i),t.push(n[i]);return JSON.stringify(t)};e.retrieveDataAsync=function(r){var s=i.defer(),u=function(n){console.error(n);s.resolve(n)},o,f,h,c;if(angular.isUndefined(r.requireAuthentication)&&(r.requireAuthentication=e.requireAuthentication),angular.isString(r.requireAuthentication)&&(r.requireAuthentication=r.requireAuthentication=="true"),r.requireAuthentication&&e.isAuthenticated()===!1)if(e.userData.refreshToken)e.refreshSession(!0);else return{promise:i(function(n){n(null)}),cancel:u};return(o=e.checksum(r),(r.requestMethod=="GET"||r.requestMethod=="POST")&&e.useCache&&(f=e.cache.get(o),angular.isDefined(f)&&f.Expiration.getTime()>(new Date).getTime()))?{promise:i(function(n){n(f.Set)}),cancel:u}:(h=n({url:r.serverUrl,method:r.requestMethod,data:r.data,timeout:s.promise}).then(function(n){return t.cancel(c),e.useCache&&e.cache.put(o,{Expiration:e.getExpirationDate(),Set:n.data}),n.data},function(n){if(angular.isDefined(n)&&angular.isDefined(n.status)&&n.status==401&&e.isAuthenticated()){if(e.userData.refreshToken)return e.refreshSession(!0),e.retrieveDataAsync(r);e.removeAuthentication();document.location=document.location}return i.reject(n)}),r.timeout=r.timeout||15e3,c=t(function(){u("Timed out")},r.timeout),{promise:h,cancel:u})};e.get=function(t,r){if(e.requireAuthentication&&!e.isAuthenticated()){var u=i.defer();return{promise:i(function(n){n(null)}),cancel:function(n){console.error(n);u.resolve(n)}}}return{promise:n.get(t,r).then(function(n){return n.data})}};e.getBinary=function(n){return e.get(n,{responseType:"arraybuffer"})};e.delete=function(n){return e.retrieveDataAsync({serverUrl:n,requestMethod:"DELETE"})};e.post=function(n,t){return e.retrieveDataAsync({serverUrl:n,requestMethod:"POST",data:t})};e.postBinary=function(t,r){var o=i.defer(),u=function(n){console.error(n);o.resolve(n)},f;return e.requireAuthentication&&e.isAuthenticated()===!1?{promise:i(function(n){n(null)}),cancel:u}:(f=n({url:t,method:"POST",headers:{"Content-Type":undefined},transformRequest:function(n){return n},data:r}),{promise:f,cancel:u})};e.put=function(n,t){return e.retrieveDataAsync({serverUrl:n,requestMethod:"PUT",data:t})};e.getByKey=function(n,t){var i=e.addTimeZoneToUrl(n).split("?"),r=i[0]+t;return i.length>1&&(r+="?"+i[1]),e.get(r)};e.instances=[];e.registerService=function(n,t){e.instances[n]=t};e.getDataService=function(n){if(angular.isUndefined(n)||n==null||n==="tubularHttp")return e;var t=e.instances[n];return t==null?e:t}}])}(),function(){angular.module("tubular.services").service("tubularLocalData",["tubularHttp","$q","$filter",function(n,t,i){var r=this,u;r.retrieveDataAsync=function(i){i.requireAuthentication=!1;var u=function(n){console.error(n);t.defer().resolve(n)};return i.serverUrl.indexOf("data:")===0?{promise:t(function(n){var t=i.serverUrl.substr(29),u;t=atob(t);u=angular.fromJson(t);n(r.pageRequest(i.data,u))}),cancel:u}:{promise:t(function(t){t(n.retrieveDataAsync(i).promise.then(function(n){return r.pageRequest(i.data,n)}))}),cancel:u}};u=function(n){var r={},t,i;for(t in n)if(n.hasOwnProperty(t))for(i in n[t])n[t].hasOwnProperty(i)&&(r[i]=n[t][i].toLocaleLowerCase());return r};r.pageRequest=function(n,t){var r={Counter:0,CurrentPage:1,FilteredRecordCount:0,TotalRecordCount:0,Payload:[],TotalPages:0},f,e,o,s,h,c,l;if(t.length===0)return r;f=t;e=n.Columns.filter(function(n){return n.SortOrder>0}).map(function(n){return(n.SortDirection==="Descending"?"-":"")+n.Name});for(o in e)e.hasOwnProperty(o)&&(f=i("orderBy")(f,e[o]));return s=n.Columns.filter(function(n){return n.Filter&&n.Filter.Text}).map(function(n){var t={};return n.Filter.Operator==="Contains"&&(t[n.Name]=n.Filter.Text),t}),s.length>0&&(f=i("filter")(f,u(s))),n.Search&&n.Search.Operator==="Auto"&&n.Search.Text&&(h=n.Columns.filter(function(n){return n.Searchable}).map(function(t){var i={};return i[t.Name]=n.Search.Text,i}),h.length>0&&(f=i("filter")(f,function(n){var i=u(h),t=!1;return angular.forEach(i,function(i,r){n[r]&&n[r].toLocaleLowerCase().indexOf(i)>=0&&(t=!0)}),t}))),r.FilteredRecordCount=f.length,r.TotalRecordCount=f.length,r.Payload=f.slice(n.Skip,n.Take+n.Skip),r.TotalPages=(r.FilteredRecordCount+n.Take-1)/n.Take,r.TotalPages>0&&(c=Math.pow(10,0),l=1+n.Skip/r.FilteredRecordCount*r.TotalPages,r.CurrentPage=(l*c|0)/c,r.CurrentPage<1&&(r.CurrentPage=1)),r};r.saveDataAsync=function(){};r.get=function(t){n.get(t)};r.delete=function(t){n.delete(t)};r.post=function(t,i){n.post(t,i)};r.put=function(t,i){n.put(t,i)};r.getByKey=function(t,i){n.getByKey(t,i)}}])}(),function(){angular.module("tubular.services").service("tubularOData",["tubularHttp",function(n){var t=this;t.operatorsMapping={None:"",Equals:"{0} eq {1}",NotEquals:"{0} ne {1}",Contains:"substringof({1}, {0}) eq true",StartsWith:"startswith({0}, {1}) eq true",EndsWith:"endswith({0}, {1}) eq true",NotContains:"substringof({1}, {0}) eq false",NotStartsWith:"startswith({0}, {1}) eq false",NotEndsWith:"endswith({0}, {1}) eq false",Gte:"{0} ge {1}",Gt:"{0} gt {1}",Lte:"{0} le {1}",Lt:"{0} lt {1}"};t.generateUrl=function(n){var i=n.data,r=n.serverUrl,f,u,e;return r+=r.indexOf("?")>0?"&":"?",r+="$format=json&$inlinecount=allpages",r+="&$select="+i.Columns.map(function(n){return n.Name}).join(","),i.Take!=-1&&(r+="&$skip="+i.Skip,r+="&$top="+i.Take),f=i.Columns.filter(function(n){return n.SortOrder>0}).sort(function(n,t){return n.SortOrder-t.SortOrder}).map(function(n){return n.Name+" "+(n.SortDirection=="Descending"?"desc":"")}),f.length>0&&(r+="&$orderby="+f.join(",")),u=i.Columns.filter(function(n){return n.Filter&&n.Filter.Text}).map(function(n){return t.operatorsMapping[n.Filter.Operator].replace("{0}",n.Name).replace("{1}",n.DataType=="string"?"'"+n.Filter.Text+"'":n.Filter.Text)}).filter(function(n){return n.length>1}),i.Search&&i.Search.Operator==="Auto"&&(e=i.Columns.filter(function(n){return n.Searchable}).map(function(n){return"startswith({0}, '{1}') eq true".replace("{0}",n.Name).replace("{1}",i.Search.Text)}),e.length>0&&u.push("("+e.join(" or ")+")")),u.length>0&&(r+="&$filter="+u.join(" and ")),r};t.retrieveDataAsync=function(i){var r=i.data,e=i.serverUrl,u,f;return i.serverUrl=t.generateUrl(i),i.data=null,u=n.retrieveDataAsync(i),f=u.promise.then(function(n){var u={Payload:n.value,CurrentPage:1,TotalPages:1,TotalRecordCount:1,FilteredRecordCount:1};return u.TotalRecordCount=parseInt(n["odata.count"]),u.FilteredRecordCount=u.TotalRecordCount,u.TotalPages=parseInt((u.FilteredRecordCount+r.Take-1)/r.Take),u.CurrentPage=parseInt(1+r.Skip/u.FilteredRecordCount*u.TotalPages),u.CurrentPage>u.TotalPages&&(u.CurrentPage=1,i.data=r,i.data.Skip=0,i.serverUrl=e,t.retrieveDataAsync(i).promise.then(function(n){u.Payload=n.value})),u}),{promise:f,cancel:u.cancel}};t.saveDataAsync=function(t,i){return n.saveDataAsync(t,i)};t.get=function(t){return n.get(t)};t.delete=function(t){return n.delete(t)};t.post=function(t,i){return n.post(t,i)};t.put=function(t,i){return n.put(t,i)};t.getByKey=function(t,i){return n.get(t+"("+i+")")}}])}(),function(){angular.module("tubular.services").service("tubularTemplateService",["$templateCache",function(n){var t=this;t.enums=tubularTemplateServiceModule.enums;t.defaults=tubularTemplateServiceModule.defaults;t.generatePopup=function(t,i){var r="temp"+(new Date).getTime()+".html",u=tubularTemplateServiceModule.generatePopup(t,i);return n.put(r,u),r};t.createColumns=function(n){return tubularTemplateServiceModule.createColumns(n)};t.generateForm=function(n,t){return tubularTemplateServiceModule.generateForm(n,t)};t.generateGrid=function(n,t){return tubularTemplateServiceModule.generateGrid(n,t)}}])}(),function(){angular.module("tubular.services").service("tubularTranslate",[function(){var n=this;n.currentLanguage="en";n.defaultLanguage="en";n.translationTable={en:{EDITOR_REGEX_DOESNT_MATCH:"The field doesn't match the regular expression.",EDITOR_REQUIRED:"The field is required.",EDITOR_MIN_CHARS:"The field needs to be minimum {0} chars.",EDITOR_MAX_CHARS:"The field needs to be maximum {0} chars.",EDITOR_MIN_NUMBER:"The minimum number is {0}.",EDITOR_MAX_NUMBER:"The maximum number is {0}.",EDITOR_MIN_DATE:"The minimum date is {0}.",EDITOR_MAX_DATE:"The maximum date is {0}.",EDITOR_MATCH:"The field needs to match the {0} field.",CAPTION_APPLY:"Apply",CAPTION_CLEAR:"Clear",CAPTION_CLOSE:"Close",CAPTION_SELECTCOLUMNS:"Select Columns",CAPTION_FILTER:"Filter",CAPTION_VALUE:"Value",CAPTION_REMOVE:"Remove",CAPTION_CANCEL:"Cancel",CAPTION_EDIT:"Edit",CAPTION_SAVE:"Save",CAPTION_PRINT:"Print",CAPTION_LOAD:"Load",CAPTION_ADD:"Add",UI_SEARCH:"search . . .",UI_PAGESIZE:"Page size:",UI_EXPORTCSV:"Export CSV",UI_CURRENTROWS:"Current rows",UI_ALLROWS:"All rows",UI_REMOVEROW:"Do you want to delete this row?",UI_SHOWINGRECORDS:"Showing {0} to {1} of {2} records",UI_FILTEREDRECORDS:"(Filtered from {0} total records)",UI_HTTPERROR:"Unable to contact server; please, try again later.",UI_GENERATEREPORT:"Generate Report",UI_TWOCOLS:"Two columns",UI_ONECOL:"One column",UI_MAXIMIZE:"Maximize",UI_RESTORE:"Restore",UI_MOVEUP:"Move Up",UI_MOVEDOWN:"Move Down",UI_MOVELEFT:"Move Left",UI_MOVERIGHT:"Move Right",UI_COLLAPSE:"Collapse",UI_EXPAND:"Expand",OP_NONE:"None",OP_EQUALS:"Equals",OP_NOTEQUALS:"Not Equals",OP_CONTAINS:"Contains",OP_NOTCONTAINS:"Not Contains",OP_STARTSWITH:"Starts With",OP_NOTSTARTSWITH:"Not Starts With",OP_ENDSWITH:"Ends With",OP_NOTENDSWITH:"Not Ends With",OP_BETWEEN:"Between"},es:{EDITOR_REGEX_DOESNT_MATCH:"El campo no es v\u00e1lido contra la expresi\u00f3n regular.",EDITOR_REQUIRED:"El campo es requerido.",EDITOR_MIN_CHARS:"El campo requiere m\u00ednimo {0} caracteres.",EDITOR_MAX_CHARS:"El campo requiere m\u00e1ximo {0} caracteres.",EDITOR_MIN_NUMBER:"El n\u00famero m\u00ednimo es {0}.",EDITOR_MAX_NUMBER:"El n\u00famero maximo es {0}.",EDITOR_MIN_DATE:"La fecha m\u00ednima es {0}.",EDITOR_MAX_DATE:"La fecha m\u00e1xima es {0}.",EDITOR_MATCH:"El campo debe de conincidir con el campo {0}.",CAPTION_APPLY:"Aplicar",CAPTION_CLEAR:"Limpiar",CAPTION_CLOSE:"Cerrar",CAPTION_SELECTCOLUMNS:"Seleccionar columnas",CAPTION_FILTER:"Filtro",CAPTION_VALUE:"Valor",CAPTION_REMOVE:"Remover",CAPTION_CANCEL:"Cancelar",CAPTION_EDIT:"Editar",CAPTION_SAVE:"Guardar",CAPTION_PRINT:"Imprimir",CAPTION_LOAD:"Cargar",CAPTION_ADD:"Agregar",UI_SEARCH:"buscar . . .",UI_PAGESIZE:"# Registros:",UI_EXPORTCSV:"Exportar CSV",UI_CURRENTROWS:"Esta p\u00e1gina",UI_ALLROWS:"Todo",UI_REMOVEROW:"\u00bfDesea eliminar el registro?",UI_SHOWINGRECORDS:"Mostrando registros {0} al {1} de {2}",UI_FILTEREDRECORDS:"(De un total de {0} registros)",UI_HTTPERROR:"No se logro contactar el servidor, intente m\u00e1s tarde.",UI_GENERATEREPORT:"Generar Reporte",UI_TWOCOLS:"Dos columnas",UI_ONECOL:"Una columna",UI_MAXIMIZE:"Maximizar",UI_RESTORE:"Restaurar",UI_MOVEUP:"Mover Arriba",UI_MOVEDOWN:"Mover Abajo",UI_MOVELEFT:"Mover Izquierda",UI_MOVERIGHT:"Mover Derecha",UI_COLLAPSE:"Colapsar",UI_EXPAND:"Expandir",OP_NONE:"Ninguno",OP_EQUALS:"Igual",OP_NOTEQUALS:"No Igual",OP_CONTAINS:"Contiene",OP_NOTCONTAINS:"No Contiene",OP_STARTSWITH:"Comienza Con",OP_NOTSTARTSWITH:"No Comienza Con",OP_ENDSWITH:"Termina Con",OP_NOTENDSWITH:"No Termina Con",OP_BETWEEN:"Entre"}};n.setLanguage=function(t){return n.currentLanguage=t,n};n.addTranslation=function(t,i,r){var u=n.translationTable[t]||n.translationTable[n.currentLanguage]||n.translationTable[n.defaultLanguage];return u[i]=r,n};n.translate=function(t){var i=n.translationTable[n.currentLanguage]||n.translationTable[n.defaultLanguage];return i[t]||t};n.reverseTranslate=function(){}}]).filter("translate",["tubularTranslate",function(n){return function(t,i,r,u,f){if(angular.isDefined(t)){var e=n.translate(t);return e=e.replace("{0}",i||""),e=e.replace("{1}",r||""),e=e.replace("{2}",u||""),e.replace("{3}",f||"")}return t}}])}(),function(n){function f(n,t,i){var r=i.charAt(0);return r=="d"?new Date(n.getFullYear(),n.getMonth(),n.getDate()+t):r=="m"?new Date(n.getFullYear(),n.getMonth()+t,n.getDate()):r=="y"?new Date(n.getFullYear()+t,n.getMonth(),n.getDate()):void 0}function e(n,t,i){var r=n.charAt(0);return r=="d"?Math.round((i-t)/864e5):r=="m"?(t.getFullYear()+t.getMonth()*12-i.getFullYear()+i.getMonth()*12)/12:r=="y"?t.getFullYear()-i.getFullYear():void 0}function t(n){var t=n.match(i),u=n.replace(i,'\0').split('\0'),f,r,e,o;if(!u||!u.length||!t||t.length==0)throw new Error("Invalid date format : "+n);for(f={},r=0,e=t.length;r<e;r++)o=t[r].substr(0,1).toUpperCase(),f[o]=r;return{separators:u,parts:t,positions:f}}function o(n,t,i){switch(t){case"dd":return(100+n.getDate()).toString().substring(1);case"mm":return(100+n.getMonth()+1).toString().substring(1);case"yyyy":return n.getFullYear();case"yy":return n.getFullYear()%100;case"MM":return Date.locales[i].monthsShort[n.getMonth()];case"MMM":return Date.locales[i].months[n.getMonth()];case"d":return n.getDate();case"m":return n.getMonth()+1}}function s(n,i,r){var u,h;if(!n||isNaN(n))return"";var f=[],e=typeof i=="string"?t(i):i,s=e.separators;for(u=0,h=e.parts.length;u<h;u++)s[u]&&f.push(s[u]),f.push(o(n,e.parts[u],r));return f.join("")}function h(n,i){var e,r,u,f;return n?(e=typeof i=="string"?t(i):i,r=n.match(/[0-9]+/g),r&&r.length==3?(u=e.positions,new Date(r[u.Y],r[u.M]-1,r[u.D])):(f=new Date(n),isNaN(f.getTime())?undefined:f)):undefined}var i=/dd?|mm?|MM(?:M)?|yy(?:yy)?/g,r={add:f,elapsed:e,parseFormat:t,format:s,parse:h,locales:{en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}};for(var u in r)n[u]=r[u]}(this.module?this.module.exports:Date),function(n){function e(n){return n?new Date(n.atMidnight()):undefined}function o(){return(new Date).atMidnight()}function i(n){return n.getFullYear()*100+n.getMonth()}function r(n){n.stopPropagation();n.preventDefault()}function u(n,t){return t==0?"":Array(t+1).join(n)}var f={calId:"datepicker",dateFormat:"mm/dd/yyyy",language:"en",firstDayOfWeek:0,required:!1},t=function(n,t){this._init(this.$target=n,this.settings=t)};t.prototype={_init:function(i,r){var u=r.locale,e,f;u&&(e=t.locales[u],n.extend(r,{language:u},e.defaults));this.$cal=t.build(r.calId,r.language);this.setDateFormat(r.format||r.dateFormat).setStartDate(r.startDate).setEndDate(r.endDate);this.firstDayOfWeek=r.firstDayOfWeek;this.locale=t.getLocale(r.language);this.defaultDate=r.defaultDate||o();this.setDate(Date.parse(i.val(),this.parsedFormat));f=n.proxy(this.show,this);i.data("calendar",this).click(f).focus(f).keydown(n.proxy(this.keyHandler,this)).blur(n.proxy(this.validate,this))},_parse:function(n){return n?typeof n=="string"?Date.parse(n,this.parsedFormat):e(n):undefined},show:function(n){var i,u,f,e;if(r(n),i=this.$cal,u=this.$target,!this.$target.data("dirty")){if(i.hasClass("active")){if(i.data("calendar")===this)return;t.hide(i)}f=u.offset();e=this._parse(u.val());this.setDate(e).refreshDays().refresh().select();this.$cal.css({left:f.left,top:f.top+u.outerHeight(!1)}).slideDown(200).addClass("active").data("calendar",this);this._keyHandler=this.activeKeyHandler}},hide:function(){return t.hide(this.$cal),this._keyHandler=this.inactiveKeyHandler,this},refreshDays:function(){var t=this.locale.daysMin,i=this.firstDayOfWeek;return this.$cal.data("$dayHeaders").each(function(r,u){n(u).text(t[r+i])}),this},refresh:function(){var n=new Date(this.displayedDate.getTime()),u=i(this.displayedDate),f=this.$cal,s=f.data("$days"),t;for(f.data("$header").text(Date.format(n,"MMM yyyy",this.settings.language));n.getDay()!=this.firstDayOfWeek;)n=Date.add(n,-1,"day");var h=this.selectedIndex=this.selectedDate?Date.elapsed("days",n,this.selectedDate):undefined,c=this.startDate?Date.elapsed("days",n,this.startDate):-Infinity,l=this.endDate?Date.elapsed("days",n,this.endDate):+Infinity;for(t=0;t<42;t++){var e=i(n),o=s[t],r="day";o.innerHTML=n.getDate();e<u?r+=" old":e>u?r+=" new":t==h&&(r+=" active");(t<c||t>l)&&(r+=" disabled");o.className=r;n=Date.add(n,1,"day")}return this},navigate:function(t,r,u){u||this.selectedDate||(t=0);var f=Date.add(u?this.displayedDate:this.selectedDate||this.defaultDate,t,r),e=this.$cal.data("$days");return this.startDate&&i(f)<i(this.startDate)||this.endDate&&i(f)>i(this.endDate)?this.select():(i(f)==i(this.displayedDate)&&this.selectedIndex?(n(e[this.selectedIndex]).removeClass("active"),e[this.selectedIndex+=t].className+=" active",this.setDate(f)):(u?this.displayedDate=f:this.setDate(f),this.refresh()),this.select(),!1)},select:function(){return this.$target.data("dirty",!0).select().data("dirty",!1),this},setStartDate:function(n){return this.startDate=this._parse(n),this},setEndDate:function(n){return this.endDate=this._parse(n),this},setDate:function(n){return this._parse(n)?(this.selectedDate=n,this.displayedDate=new Date(n),this.$target.data("date",n).val(Date.format(n,this.parsedFormat))):(this.selectedDate=this.selectedIndex=null,this.displayedDate=new Date(this.defaultDate),this.$target.data("date",null).val("")),this.displayedDate.setDate(1),this.dirty=!1,this},setDateFormat:function(n){return this.parsedFormat=Date.parseFormat(this.dateFormat=n),this},keyHandler:function(n){return this._keyHandler(n)},activeKeyHandler:function(n){switch(n.keyCode){case 37:return n.ctrlKey?this.navigate(-1,"month"):this.navigate(-1,"day");case 38:return n.ctrlKey?this.navigate(-1,"year"):this.navigate(-7,"days");case 39:return n.ctrlKey?this.navigate(1,"month"):this.navigate(1,"day");case 40:return n.ctrlKey?this.navigate(1,"year"):this.navigate(7,"days");case 33:return n.ctrlKey?this.navigate(-10,"years"):this.navigate(-1,"year");case 34:return n.ctrlKey?this.navigate(10,"years"):this.navigate(1,"year");case 35:return this.navigate(1,"month");case 36:return this.navigate(-1,"month");case 9:case 13:return this.$target.trigger({type:"dateChange",date:this.selectedDate}),this.hide();case 27:return this.hide()}this.dirty=!0},inactiveKeyHandler:function(n){n.keyCode<41&&n.keyCode>32?(this.show(n),this._keyHandler=this.activeKeyHandler):this.dirty=!0},validate:function(){if(this.dirty){var t=this.$target,n=this._parse(t.val());n?n-this.selectedDate&&(n<this.startDate||n>this.endDate?this.setDate(this.selectedDate):(this.setDate(n),t.trigger({type:"dateChange",date:this.selectedDate}))):this.setDate(this.required?this.selectedDate||this.defaultDate:null);this.hide()}}};t.template="<table class='table-condensed'><thead><tr><th class='prev month'>&laquo;<\/th><th class='month name' colspan='5'><\/th><th class='next month'>&raquo;<\/th><\/tr><tr>"+u("<th class='dow'/>",7)+"<\/tr><\/thead><tbody>"+u("<tr>"+u("<td class='day'/>",7)+"<\/tr>",6)+"<\/tbody><\/table>";t.build=function(i){var u=n("#"+i);if(u.length==1)return u;u=n("<div>").attr("id",i).addClass("datepicker dropdown-menu").html(t.template).appendTo("body");u.data("$days",n("td.day",u));u.data("$header",n("th.month.name",u));u.data("$dayHeaders",n("th.dow",u));u.on("click","td.day",function(t){r(t);var i=u.data("calendar"),e=n(this),s=+e.text(),o=i.displayedDate,h=e.hasClass("old")?-1:e.hasClass("new")?1:0,f=new Date(o.getFullYear(),o.getMonth()+h,s);f<i.startDate||f>i.endDate||(i.setDate(f).select(),setTimeout(function(){i.$target.trigger({type:"dateChange",date:f});i.hide()},0))});u.on("click","th.month",function(t){r(t);var i=u.data("calendar");n(this).hasClass("prev")?i.navigate(-1,"month",!0):n(this).hasClass("next")&&i.navigate(1,"month",!0)});return u};t.setDefaultLocale=function(i){var r=t.locales[i];r&&t.setDefaults(n.extend({language:i},r.defaults))};t.getLocale=function(n){return t.locales[n]||t.locales.en};t.setDefaults=function(t){n.extend(f,t)};t.hide=function(t){var i=!t||t.originalEvent?n(".datepicker.active"):t;i.removeClass("active").removeAttr("style")};n(document).bind("click",t.hide);n.fn.datepicker=function(i){if(i&&typeof i!="object"){if(t.prototype[i]){var r=i,u=Array.prototype.slice.call(arguments,1);return n(this).each(function(t,i){var f=n(i).data("datepicker");try{f[r].apply(f,u)}catch(e){}})}n.error("Method "+i+" does not exist on jquery.datepicker")}else return n(this).each(function(r,u){var e=n.extend({},f,i),o=new t(n(u),e);n(u).data("datepicker",o)})};n.fn.datepicker.Calendar=t;n.fn.datepicker.Calendar.locales=Date.locales||{en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};Date.prototype.atMidnight=function(){return this.setHours(0,0,0,0),this}}(jQuery);